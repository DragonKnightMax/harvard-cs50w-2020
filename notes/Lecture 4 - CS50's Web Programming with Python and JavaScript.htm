<!DOCTYPE html>
<html class="wf-ptsans-n4-active wf-ptsans-n7-active wf-active" lang="en-us"><head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">

        <meta charset="utf-8">
        <meta name="viewport" content="initial-scale=1, width=device-width"><meta property="og:description" content="This course picks up where Harvard University's CS50 leaves off, diving more deeply into the design and implementation of web apps with Python, JavaScript, and SQL using frameworks like Django, React, and Bootstrap. Topics include database design, scalability, security, and user experience. Through hands-on projects, students learn to write and use APIs, create interactive UIs, and leverage cloud services like GitHub and Heroku. By semester’s end, students emerge with knowledge and experience in principles, languages, and tools that empower them to design and deploy applications on the Internet.">

        <meta property="og:image" content="https://img.youtube.com/vi/24Kf3v7kZyE/maxresdefault.jpg"><meta property="og:title" content="Lecture 4 - CS50's Web Programming with Python and JavaScript">

        <link href="https://cs50.harvard.edu/web/2020/favicon.ico?1645555620" rel="icon">

        <!-- https://fonts.google.com/specimen/PT+Sans?query=PT+Sans&selection.family=PT+Sans:ital,wght@0,400;0,700;1,400;1,700 -->
        <script src="Lecture%204%20-%20CS50's%20Web%20Programming%20with%20Python%20and%20JavaScript_files/webfont.js"></script>

        <!-- http://getbootstrap.com/docs/4.6/getting-started/introduction/ -->
        <script src="Lecture%204%20-%20CS50's%20Web%20Programming%20with%20Python%20and%20JavaScript_files/jquery.js"></script>
        <script src="Lecture%204%20-%20CS50's%20Web%20Programming%20with%20Python%20and%20JavaScript_files/bootstrap.js"></script>

        <!-- https://bootstrap-table.com/docs/getting-started/introduction/ -->
        <link href="Lecture%204%20-%20CS50's%20Web%20Programming%20with%20Python%20and%20JavaScript_files/bootstrap-table.css" rel="stylesheet">
        <script src="Lecture%204%20-%20CS50's%20Web%20Programming%20with%20Python%20and%20JavaScript_files/bootstrap-table.js"></script>
        <script src="Lecture%204%20-%20CS50's%20Web%20Programming%20with%20Python%20and%20JavaScript_files/bootstrap-table-mobile.js"></script>

        <!-- https://fontawesome.com/how-to-use/on-the-web/referencing-icons/basic-use -->
        <link href="Lecture%204%20-%20CS50's%20Web%20Programming%20with%20Python%20and%20JavaScript_files/all.css" rel="stylesheet">

        <!-- https://moment.github.io/luxon/ -->
        <script src="Lecture%204%20-%20CS50's%20Web%20Programming%20with%20Python%20and%20JavaScript_files/luxon.js"></script>

        <!-- http://docs.mathjax.org/ -->
        <!-- https://www.jsdelivr.com/package/npm/mathjax?path=es5 -->
        <script crossorigin="anonymous" integrity="sha256-+nfSJ1LiSvANSK3wvi6FjM+oFwoIQvURU1frozp5z6o=" src="Lecture%204%20-%20CS50's%20Web%20Programming%20with%20Python%20and%20JavaScript_files/tex-chtml.js"></script><style type="text/css">.CtxtMenu_InfoClose {  top:.2em; right:.2em;}
.CtxtMenu_InfoContent {  overflow:auto; text-align:left; font-size:80%;  padding:.4em .6em; border:1px inset; margin:1em 0px;  max-height:20em; max-width:30em; background-color:#EEEEEE;  white-space:normal;}
.CtxtMenu_Info.CtxtMenu_MousePost {outline:none;}
.CtxtMenu_Info {  position:fixed; left:50%; width:auto; text-align:center;  border:3px outset; padding:1em 2em; background-color:#DDDDDD;  color:black;  cursor:default; font-family:message-box; font-size:120%;  font-style:normal; text-indent:0; text-transform:none;  line-height:normal; letter-spacing:normal; word-spacing:normal;  word-wrap:normal; white-space:nowrap; float:none; z-index:201;  border-radius: 15px;                     /* Opera 10.5 and IE9 */  -webkit-border-radius:15px;               /* Safari and Chrome */  -moz-border-radius:15px;                  /* Firefox */  -khtml-border-radius:15px;                /* Konqueror */  box-shadow:0px 10px 20px #808080;         /* Opera 10.5 and IE9 */  -webkit-box-shadow:0px 10px 20px #808080; /* Safari 3 & Chrome */  -moz-box-shadow:0px 10px 20px #808080;    /* Forefox 3.5 */  -khtml-box-shadow:0px 10px 20px #808080;  /* Konqueror */  filter:progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color="gray", Positive="true"); /* IE */}
</style><style type="text/css">.CtxtMenu_MenuClose {  position:absolute;  cursor:pointer;  display:inline-block;  border:2px solid #AAA;  border-radius:18px;  -webkit-border-radius: 18px;             /* Safari and Chrome */  -moz-border-radius: 18px;                /* Firefox */  -khtml-border-radius: 18px;              /* Konqueror */  font-family: "Courier New", Courier;  font-size:24px;  color:#F0F0F0}
.CtxtMenu_MenuClose span {  display:block; background-color:#AAA; border:1.5px solid;  border-radius:18px;  -webkit-border-radius: 18px;             /* Safari and Chrome */  -moz-border-radius: 18px;                /* Firefox */  -khtml-border-radius: 18px;              /* Konqueror */  line-height:0;  padding:8px 0 6px     /* may need to be browser-specific */}
.CtxtMenu_MenuClose:hover {  color:white!important;  border:2px solid #CCC!important}
.CtxtMenu_MenuClose:hover span {  background-color:#CCC!important}
.CtxtMenu_MenuClose:hover:focus {  outline:none}
</style><style type="text/css">.CtxtMenu_Menu {  position:absolute;  background-color:white;  color:black;  width:auto; padding:5px 0px;  border:1px solid #CCCCCC; margin:0; cursor:default;  font: menu; text-align:left; text-indent:0; text-transform:none;  line-height:normal; letter-spacing:normal; word-spacing:normal;  word-wrap:normal; white-space:nowrap; float:none; z-index:201;  border-radius: 5px;                     /* Opera 10.5 and IE9 */  -webkit-border-radius: 5px;             /* Safari and Chrome */  -moz-border-radius: 5px;                /* Firefox */  -khtml-border-radius: 5px;              /* Konqueror */  box-shadow:0px 10px 20px #808080;         /* Opera 10.5 and IE9 */  -webkit-box-shadow:0px 10px 20px #808080; /* Safari 3 & Chrome */  -moz-box-shadow:0px 10px 20px #808080;    /* Forefox 3.5 */  -khtml-box-shadow:0px 10px 20px #808080;  /* Konqueror */}
.CtxtMenu_MenuItem {  padding: 1px 2em;  background:transparent;}
.CtxtMenu_MenuArrow {  position:absolute; right:.5em; padding-top:.25em; color:#666666;  font-family: null; font-size: .75em}
.CtxtMenu_MenuActive .CtxtMenu_MenuArrow {color:white}
.CtxtMenu_MenuArrow.CtxtMenu_RTL {left:.5em; right:auto}
.CtxtMenu_MenuCheck {  position:absolute; left:.7em;  font-family: null}
.CtxtMenu_MenuCheck.CtxtMenu_RTL { right:.7em; left:auto }
.CtxtMenu_MenuRadioCheck {  position:absolute; left: .7em;}
.CtxtMenu_MenuRadioCheck.CtxtMenu_RTL {  right: .7em; left:auto}
.CtxtMenu_MenuInputBox {  padding-left: 1em; right:.5em; color:#666666;  font-family: null;}
.CtxtMenu_MenuInputBox.CtxtMenu_RTL {  left: .1em;}
.CtxtMenu_MenuComboBox {  left:.1em; padding-bottom:.5em;}
.CtxtMenu_MenuSlider {  left: .1em;}
.CtxtMenu_SliderValue {  position:absolute; right:.1em; padding-top:.25em; color:#333333;  font-size: .75em}
.CtxtMenu_SliderBar {  outline: none; background: #d3d3d3}
.CtxtMenu_MenuLabel {  padding: 1px 2em 3px 1.33em;  font-style:italic}
.CtxtMenu_MenuRule {  border-top: 1px solid #DDDDDD;  margin: 4px 3px;}
.CtxtMenu_MenuDisabled {  color:GrayText}
.CtxtMenu_MenuActive {  background-color: #606872;  color: white;}
.CtxtMenu_MenuDisabled:focus {  background-color: #E8E8E8}
.CtxtMenu_MenuLabel:focus {  background-color: #E8E8E8}
.CtxtMenu_ContextMenu:focus {  outline:none}
.CtxtMenu_ContextMenu .CtxtMenu_MenuItem:focus {  outline:none}
.CtxtMenu_SelectionMenu {  position:relative; float:left;  border-bottom: none; -webkit-box-shadow:none; -webkit-border-radius:0px; }
.CtxtMenu_SelectionItem {  padding-right: 1em;}
.CtxtMenu_Selection {  right: 40%; width:50%; }
.CtxtMenu_SelectionBox {  padding: 0em; max-height:20em; max-width: none;  background-color:#FFFFFF;}
.CtxtMenu_SelectionDivider {  clear: both; border-top: 2px solid #000000;}
.CtxtMenu_Menu .CtxtMenu_MenuClose {  top:-10px; left:-10px}
</style>

        <!-- https://github.com/verlok/vanilla-lazyload -->
        <script src="Lecture%204%20-%20CS50's%20Web%20Programming%20with%20Python%20and%20JavaScript_files/intersection-observer.js"></script>
        <script src="Lecture%204%20-%20CS50's%20Web%20Programming%20with%20Python%20and%20JavaScript_files/lazyload.js"></script>

        <!-- https://github.com/davidjbradshaw/iframe-resizer -->
        <!-- https://www.jsdelivr.com/package/npm/iframe-resizer?path=js -->
        <script crossorigin="anonymous" integrity="sha256-S8f0Q/V9VcfrqYgWo9EFS9zuDMdPTBMC+CBW0RjxQbs=" src="Lecture%204%20-%20CS50's%20Web%20Programming%20with%20Python%20and%20JavaScript_files/iframeResizer.js"></script>

        <!-- https://github.com/scratchblocks/scratchblocks/releases -->
        <script src="Lecture%204%20-%20CS50's%20Web%20Programming%20with%20Python%20and%20JavaScript_files/scratchblocks.js"></script><style><![CDATA[ .sb-label {
      font-family: Lucida Grande, Verdana, Arial, DejaVu Sans, sans-serif;
      font-weight: bold;
      fill: #fff;
      font-size: 10px;
      word-spacing: +1px;
    }

    .sb-obsolete { fill: #d42828; }
    .sb-motion { fill: #4a6cd4; }
    .sb-looks { fill: #8a55d7; }
    .sb-sound { fill: #bb42c3; }
    .sb-pen { fill: #0e9a6c;  }
    .sb-events { fill: #c88330; }
    .sb-control { fill: #e1a91a; }
    .sb-sensing { fill: #2ca5e2; }
    .sb-operators { fill: #5cb712; }
    .sb-variables { fill: #ee7d16; }
    .sb-list { fill: #cc5b22 }
    .sb-custom { fill: #632d99; }
    .sb-custom-arg { fill: #5947b1; }
    .sb-extension { fill: #4b4a60; }
    .sb-grey { fill: #969696; }

    .sb-bevel {
      filter: url(#bevelFilter);
    }

    .sb-input {
      filter: url(#inputBevelFilter);
    }
    .sb-input-number,
    .sb-input-string,
    .sb-input-number-dropdown {
      fill: #fff;
    }
    .sb-literal-number,
    .sb-literal-string,
    .sb-literal-number-dropdown,
    .sb-literal-dropdown {
      font-weight: normal;
      font-size: 9px;
      word-spacing: 0;
    }
    .sb-literal-number,
    .sb-literal-string,
    .sb-literal-number-dropdown {
      fill: #000;
    }

    .sb-darker {
      filter: url(#inputDarkFilter);
    }

    .sb-outline {
      stroke: #fff;
      stroke-opacity: 0.2;
      stroke-width: 2;
      fill: none;
    }

    .sb-define-hat-cap {
      stroke: #632d99;
      stroke-width: 1;
      fill: #8e2ec2;
    }

    .sb-comment {
      fill: #ffffa5;
      stroke: #d0d1d2;
      stroke-width: 1;
    }
    .sb-comment-line {
      fill: #ffff80;
    }
    .sb-comment-label {
      font-family: Helevetica, Arial, DejaVu Sans, sans-serif;
      font-weight: bold;
      fill: #5c5d5f;
      word-spacing: 0;
      font-size: 12px;
    }

    .sb-diff {
      fill: none;
      stroke: #000;
    }
    .sb-diff-ins {
      stroke-width: 2px;
    }
    .sb-diff-del {
      stroke-width: 3px;
    }
  ]]></style><style><![CDATA[ .sb3-label {
      font: 500 12pt Helevetica Neue, Helvetica, sans-serif;
      fill: #fff;
      word-spacing: +1pt;
    }

    .sb3-motion { fill: #4c97ff; stroke: #3373cc; }
    .sb3-motion-alt { fill: #4280d7; }
    .sb3-motion-dark { fill: #4c97ff; }
    .sb3-looks { fill: #9966ff; stroke: #774dcb; }
    .sb3-looks-alt { fill: #855cd6; }
    .sb3-looks-dark { fill: #bd42bd; }
    .sb3-sound { fill: #cf63cf; stroke: #bd42bd; }
    .sb3-sound-alt { fill: #c94fc9; }
    .sb3-sound-dark { fill: #bd42bd; }
    .sb3-control { fill: #ffab19; stroke: #cf8b17; }
    .sb3-control-alt { fill: #ec9c13; }
    .sb3-control-dark { fill: #cf8b17; }
    .sb3-events { fill: #ffbf00; stroke: #cc9900; }
    .sb3-events-alt { fill: #e6ac00; }
    .sb3-events-dark { fill: #cc9900; }
    .sb3-sensing { fill: #5cb1d6; stroke: #2e8eb8; }
    .sb3-sensing-alt { fill: #47a8d1; }
    .sb3-sensing-dark { fill: #2e8eb8; }
    .sb3-operators { fill: #59c059; stroke: #389438; }
    .sb3-operators-alt { fill: #46b946; }
    .sb3-operators-dark { fill: #389438; }
    .sb3-variables { fill: #ff8c1a; stroke: #db6e00; }
    .sb3-variables-alt { fill: #ff8000; }
    .sb3-variables-dark { fill: #db6e00; }
    .sb3-list { fill: #ff661a; stroke: #e64d00; }
    .sb3-list-alt { fill: #ff5500; }
    .sb3-list-dark { fill: #e64d00; }
    .sb3-custom { fill: #ff6680; stroke: #ff3355; }
    .sb3-custom-alt { fill: #ff4d6a; }
    .sb3-custom-dark { fill: #ff3355; }
    .sb3-custom-arg { fill: #ff6680; stroke: #ff3355; }

    /* extension blocks, e.g. pen */
    .sb3-extension { fill: #0fbd8c; stroke: #0b8e69; }
    .sb3-extension-alt { fill: #0da57a; }
    .sb3-extension-line { stroke: #0da57a; }
    .sb3-extension-dark { fill: #0b8e69; }

    /* obsolete colors: chosen by hand, indicates invalid blocks */
    .sb3-obsolete { fill: #ed4242; stroke: #ca2b2b; }
    .sb3-obsolete-alt { fill: #db3333; }
    .sb3-obsolete-dark { fill: #ca2b2b; }

    /* grey: special color from the Scratch 3.0 design mockups */
    .sb3-grey { fill: #bfbfbf; stroke: #909090; }
    .sb3-grey-alt { fill: #b2b2b2; }
    .sb3-grey-dark { fill: #909090; }

    .sb3-input-color {
      stroke: #fff;
    }

    .sb3-input-number,
    .sb3-input-string {
      fill: #fff;
    }
    .sb3-literal-number,
    .sb3-literal-string,
    .sb3-literal-number-dropdown,
    .sb3-literal-dropdown {
      word-spacing: 0;
    }
    .sb3-literal-number,
    .sb3-literal-string {
      fill: #575e75;
    }

    .sb3-comment {
      fill: #ffffa5;
      stroke: #d0d1d2;
      stroke-width: 1;
    }
    .sb3-comment-line {
      fill: #ffff80;
    }
    .sb3-comment-label {
      font: 400 12pt Helevetica Neue, Helvetica, sans-serif;
      fill: #000;
      word-spacing: 0;
    }

    .sb3-diff {
      fill: none;
      stroke: #000;
    }
    .sb3-diff-ins {
      stroke-width: 2px;
    }
    .sb3-diff-del {
      stroke-width: 3px;
    }
  ]]></style>

        

        <link href="Lecture%204%20-%20CS50's%20Web%20Programming%20with%20Python%20and%20JavaScript_files/page.css" rel="stylesheet">
        <link rel="stylesheet" href="Lecture%204%20-%20CS50's%20Web%20Programming%20with%20Python%20and%20JavaScript_files/css.css" media="all"><script src="Lecture%204%20-%20CS50's%20Web%20Programming%20with%20Python%20and%20JavaScript_files/jekyll-theme-cs50.js"></script>

        <script>
            window.CS50 = {
                local: {"day":"numeric","hour":"numeric","minute":"numeric","month":"long","timeZoneName":"short","weekday":"long","year":"numeric"},
                locale: "en",
                tz: "America/New_York"
            };
        </script>

        <title>Lecture 4 - CS50's Web Programming with Python and JavaScript</title>


    <style id="MJX-CHTML-styles">
mjx-container[jax="CHTML"] {
  line-height: 0;
}

mjx-container [space="1"] {
  margin-left: .111em;
}

mjx-container [space="2"] {
  margin-left: .167em;
}

mjx-container [space="3"] {
  margin-left: .222em;
}

mjx-container [space="4"] {
  margin-left: .278em;
}

mjx-container [space="5"] {
  margin-left: .333em;
}

mjx-container [rspace="1"] {
  margin-right: .111em;
}

mjx-container [rspace="2"] {
  margin-right: .167em;
}

mjx-container [rspace="3"] {
  margin-right: .222em;
}

mjx-container [rspace="4"] {
  margin-right: .278em;
}

mjx-container [rspace="5"] {
  margin-right: .333em;
}

mjx-container [size="s"] {
  font-size: 70.7%;
}

mjx-container [size="ss"] {
  font-size: 50%;
}

mjx-container [size="Tn"] {
  font-size: 60%;
}

mjx-container [size="sm"] {
  font-size: 85%;
}

mjx-container [size="lg"] {
  font-size: 120%;
}

mjx-container [size="Lg"] {
  font-size: 144%;
}

mjx-container [size="LG"] {
  font-size: 173%;
}

mjx-container [size="hg"] {
  font-size: 207%;
}

mjx-container [size="HG"] {
  font-size: 249%;
}

mjx-container [width="full"] {
  width: 100%;
}

mjx-box {
  display: inline-block;
}

mjx-block {
  display: block;
}

mjx-itable {
  display: inline-table;
}

mjx-row {
  display: table-row;
}

mjx-row > * {
  display: table-cell;
}

mjx-mtext {
  display: inline-block;
}

mjx-mstyle {
  display: inline-block;
}

mjx-merror {
  display: inline-block;
  color: red;
  background-color: yellow;
}

mjx-mphantom {
  visibility: hidden;
}

mjx-assistive-mml {
  position: absolute !important;
  top: 0px;
  left: 0px;
  clip: rect(1px, 1px, 1px, 1px);
  padding: 1px 0px 0px 0px !important;
  border: 0px !important;
  display: block !important;
  width: auto !important;
  overflow: hidden !important;
  -webkit-touch-callout: none;
  -webkit-user-select: none;
  -khtml-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
}

mjx-assistive-mml[display="block"] {
  width: 100% !important;
}

mjx-c::before {
  display: block;
  width: 0;
}

.MJX-TEX {
  font-family: MJXZERO, MJXTEX;
}

.TEX-B {
  font-family: MJXZERO, MJXTEX-B;
}

.TEX-I {
  font-family: MJXZERO, MJXTEX-I;
}

.TEX-MI {
  font-family: MJXZERO, MJXTEX-MI;
}

.TEX-BI {
  font-family: MJXZERO, MJXTEX-BI;
}

.TEX-S1 {
  font-family: MJXZERO, MJXTEX-S1;
}

.TEX-S2 {
  font-family: MJXZERO, MJXTEX-S2;
}

.TEX-S3 {
  font-family: MJXZERO, MJXTEX-S3;
}

.TEX-S4 {
  font-family: MJXZERO, MJXTEX-S4;
}

.TEX-A {
  font-family: MJXZERO, MJXTEX-A;
}

.TEX-C {
  font-family: MJXZERO, MJXTEX-C;
}

.TEX-CB {
  font-family: MJXZERO, MJXTEX-CB;
}

.TEX-FR {
  font-family: MJXZERO, MJXTEX-FR;
}

.TEX-FRB {
  font-family: MJXZERO, MJXTEX-FRB;
}

.TEX-SS {
  font-family: MJXZERO, MJXTEX-SS;
}

.TEX-SSB {
  font-family: MJXZERO, MJXTEX-SSB;
}

.TEX-SSI {
  font-family: MJXZERO, MJXTEX-SSI;
}

.TEX-SC {
  font-family: MJXZERO, MJXTEX-SC;
}

.TEX-T {
  font-family: MJXZERO, MJXTEX-T;
}

.TEX-V {
  font-family: MJXZERO, MJXTEX-V;
}

.TEX-VB {
  font-family: MJXZERO, MJXTEX-VB;
}

mjx-stretchy-v mjx-c, mjx-stretchy-h mjx-c {
  font-family: MJXZERO, MJXTEX-S1, MJXTEX-S4, MJXTEX, MJXTEX-A ! important;
}

@font-face /* 0 */ {
  font-family: MJXZERO;
  src: url("https://cdn.jsdelivr.net/npm/mathjax@3.1.2/es5/output/chtml/fonts/woff-v2/MathJax_Zero.woff") format("woff");
}

@font-face /* 1 */ {
  font-family: MJXTEX;
  src: url("https://cdn.jsdelivr.net/npm/mathjax@3.1.2/es5/output/chtml/fonts/woff-v2/MathJax_Main-Regular.woff") format("woff");
}

@font-face /* 2 */ {
  font-family: MJXTEX-B;
  src: url("https://cdn.jsdelivr.net/npm/mathjax@3.1.2/es5/output/chtml/fonts/woff-v2/MathJax_Main-Bold.woff") format("woff");
}

@font-face /* 3 */ {
  font-family: MJXTEX-I;
  src: url("https://cdn.jsdelivr.net/npm/mathjax@3.1.2/es5/output/chtml/fonts/woff-v2/MathJax_Math-Italic.woff") format("woff");
}

@font-face /* 4 */ {
  font-family: MJXTEX-MI;
  src: url("https://cdn.jsdelivr.net/npm/mathjax@3.1.2/es5/output/chtml/fonts/woff-v2/MathJax_Main-Italic.woff") format("woff");
}

@font-face /* 5 */ {
  font-family: MJXTEX-BI;
  src: url("https://cdn.jsdelivr.net/npm/mathjax@3.1.2/es5/output/chtml/fonts/woff-v2/MathJax_Math-BoldItalic.woff") format("woff");
}

@font-face /* 6 */ {
  font-family: MJXTEX-S1;
  src: url("https://cdn.jsdelivr.net/npm/mathjax@3.1.2/es5/output/chtml/fonts/woff-v2/MathJax_Size1-Regular.woff") format("woff");
}

@font-face /* 7 */ {
  font-family: MJXTEX-S2;
  src: url("https://cdn.jsdelivr.net/npm/mathjax@3.1.2/es5/output/chtml/fonts/woff-v2/MathJax_Size2-Regular.woff") format("woff");
}

@font-face /* 8 */ {
  font-family: MJXTEX-S3;
  src: url("https://cdn.jsdelivr.net/npm/mathjax@3.1.2/es5/output/chtml/fonts/woff-v2/MathJax_Size3-Regular.woff") format("woff");
}

@font-face /* 9 */ {
  font-family: MJXTEX-S4;
  src: url("https://cdn.jsdelivr.net/npm/mathjax@3.1.2/es5/output/chtml/fonts/woff-v2/MathJax_Size4-Regular.woff") format("woff");
}

@font-face /* 10 */ {
  font-family: MJXTEX-A;
  src: url("https://cdn.jsdelivr.net/npm/mathjax@3.1.2/es5/output/chtml/fonts/woff-v2/MathJax_AMS-Regular.woff") format("woff");
}

@font-face /* 11 */ {
  font-family: MJXTEX-C;
  src: url("https://cdn.jsdelivr.net/npm/mathjax@3.1.2/es5/output/chtml/fonts/woff-v2/MathJax_Calligraphic-Regular.woff") format("woff");
}

@font-face /* 12 */ {
  font-family: MJXTEX-CB;
  src: url("https://cdn.jsdelivr.net/npm/mathjax@3.1.2/es5/output/chtml/fonts/woff-v2/MathJax_Calligraphic-Bold.woff") format("woff");
}

@font-face /* 13 */ {
  font-family: MJXTEX-FR;
  src: url("https://cdn.jsdelivr.net/npm/mathjax@3.1.2/es5/output/chtml/fonts/woff-v2/MathJax_Fraktur-Regular.woff") format("woff");
}

@font-face /* 14 */ {
  font-family: MJXTEX-FRB;
  src: url("https://cdn.jsdelivr.net/npm/mathjax@3.1.2/es5/output/chtml/fonts/woff-v2/MathJax_Fraktur-Bold.woff") format("woff");
}

@font-face /* 15 */ {
  font-family: MJXTEX-SS;
  src: url("https://cdn.jsdelivr.net/npm/mathjax@3.1.2/es5/output/chtml/fonts/woff-v2/MathJax_SansSerif-Regular.woff") format("woff");
}

@font-face /* 16 */ {
  font-family: MJXTEX-SSB;
  src: url("https://cdn.jsdelivr.net/npm/mathjax@3.1.2/es5/output/chtml/fonts/woff-v2/MathJax_SansSerif-Bold.woff") format("woff");
}

@font-face /* 17 */ {
  font-family: MJXTEX-SSI;
  src: url("https://cdn.jsdelivr.net/npm/mathjax@3.1.2/es5/output/chtml/fonts/woff-v2/MathJax_SansSerif-Italic.woff") format("woff");
}

@font-face /* 18 */ {
  font-family: MJXTEX-SC;
  src: url("https://cdn.jsdelivr.net/npm/mathjax@3.1.2/es5/output/chtml/fonts/woff-v2/MathJax_Script-Regular.woff") format("woff");
}

@font-face /* 19 */ {
  font-family: MJXTEX-T;
  src: url("https://cdn.jsdelivr.net/npm/mathjax@3.1.2/es5/output/chtml/fonts/woff-v2/MathJax_Typewriter-Regular.woff") format("woff");
}

@font-face /* 20 */ {
  font-family: MJXTEX-V;
  src: url("https://cdn.jsdelivr.net/npm/mathjax@3.1.2/es5/output/chtml/fonts/woff-v2/MathJax_Vector-Regular.woff") format("woff");
}

@font-face /* 21 */ {
  font-family: MJXTEX-VB;
  src: url("https://cdn.jsdelivr.net/npm/mathjax@3.1.2/es5/output/chtml/fonts/woff-v2/MathJax_Vector-Bold.woff") format("woff");
}
</style></head>

    <body class="">

        <div class="alert fixed-top mb-0 rounded-0 shadow alert-success alert-dismissible" data-alert="success dismissible" data-hash="edc24fffed7a3a9ad8c189ef5e2aca41" id="alert" role="alert">
            <button aria-label="Close" class="btn-close" data-bs-dismiss="alert" type="button"></button><p>Interested in <a href="https://cs50.harvard.edu/web/2020/#how-to-take-this-course" class="alert-link">a verified certificate, a professional certificate, or transfer credit and accreditation</a>?
And get vaccinated (as soon as it’s available to you). 💉 <a href="https://www.who.int/news-room/feature-stories/detail/getting-the-covid-19-vaccine" class="alert-link">Here’s why</a>. <a href="https://www.google.com/search?q=covid-19+vaccine+finder" class="alert-link">Here’s how</a>.</p></div>
        

        <div class="container-fluid">

            <div class="row">

                <aside class="col-md" style="height: 513.667px; top: 81.3333px;">
 
                    <header><h1 data-id="cs50s-web-programming-with-python-and-javascript"><a href="https://cs50.harvard.edu/web/2020/">CS50’s Web Programming with Python and JavaScript</a></h1>

<p>OpenCourseWare</p>

<p><a class="pr-1 small" href="https://cs50.harvard.edu/donate">Donate<i aria-hidden="true" class="fas fa-external-link-alt ps-2"></i></a></p>

<p><a href="https://brianyu.me/">Brian Yu</a><br>
<a href="mailto:brian@cs.harvard.edu">brian@cs.harvard.edu</a></p>

<p><a href="https://cs.harvard.edu/malan/">David J. Malan</a>
<br>
<a href="mailto:malan@harvard.edu">malan@harvard.edu</a>
<br>
<a class="mr-1" href="https://www.facebook.com/dmalan"><i aria-hidden="true" class="fab fa-facebook-f" title="Facebook"></i><span class="sr-only">Facebook</span></a>
<a class="mr-1" href="https://github.com/dmalan"><i aria-hidden="true" class="fab fa-github" title="GitHub"></i><span class="sr-only">GitHub</span></a>
<a class="mr-1" href="https://www.instagram.com/davidjmalan/"><i aria-hidden="true" class="fab fa-instagram" title="Instagram"></i><span class="sr-only">Instagram</span></a>
<a class="mr-1" href="https://www.linkedin.com/in/malan/"><i aria-hidden="true" class="fab fa-linkedin" title="LinkedIn"></i><span class="sr-only">LinkedIn</span></a>
<a class="mr-1" href="https://orcid.org/0000-0001-5338-2522"><i aria-hidden="true" class="fab fa-orcid" title="ORCID"></i><span class="sr-only">ORCID</span></a>
<a class="mr-1" href="https://www.quora.com/profile/David-J-Malan"><i aria-hidden="true" class="fab fa-quora" title="Quora"></i><span class="sr-only">Quora</span></a>
<a class="mr-1" href="https://www.reddit.com/user/davidjmalan"><i aria-hidden="true" class="fab fa-reddit-alien" title="Reddit"></i><span class="sr-only">Reddit</span></a>
<a class="mr-1" href="https://www.tiktok.com/@davidjmalan"><i aria-hidden="true" class="fab fa-tiktok" title="TikTok"></i><span class="sr-only">Twitter</span></a>
<a class="mr-1" href="https://twitter.com/davidjmalan"><i aria-hidden="true" class="fab fa-twitter" title="Twitter"></i><span class="sr-only">Twitter</span></a></p></header>

                    

                    <button aria-controls="nav" aria-expanded="false" class="btn btn-sm collapsed d-md-none" data-bs-target="aside &gt; nav" data-bs-toggle="collapse">
                        Menu
                    </button>

                    <nav class="collapse d-md-block" id="nav"><hr>

<ul class="fa-ul">
  <li data-marker="*"><span class="fa-li"><i class="fas fa-square"></i></span><a href="https://cs50.harvard.edu/x/movie/">🍿 CS50x Movie Night 2022</a></li>
  <li data-marker="*"><span class="fa-li"><i class="fas fa-square"></i></span><a href="https://cs50.harvard.edu/x/puzzles/"><i class="fas fa-puzzle-piece pe-2"></i>CS50x Puzzle Day 2022</a></li>
  <li data-marker="*"><span class="fa-li"><i class="fas fa-square"></i></span><a href="https://cs50.harvard.edu/x/prepare/"><i class="fas fa-book pe-2"></i>How to Prepare for Technical Interviews</a></li>
  <li data-marker="*"><span class="fa-li"><i class="fas fa-square"></i></span><a href="https://cs50.ly/zoom"><i class="fas fa-video pe-2"></i>Zoom Meetings</a></li>
</ul>

<hr>

<ol start="0">
  <li><a href="https://cs50.harvard.edu/web/2020/weeks/0/">HTML, CSS</a></li>
  <li><a href="https://cs50.harvard.edu/web/2020/weeks/1/">Git</a></li>
  <li><a href="https://cs50.harvard.edu/web/2020/weeks/2/">Python</a></li>
  <li><a href="https://cs50.harvard.edu/web/2020/weeks/3/">Django</a></li>
  <li><a href="https://cs50.harvard.edu/web/2020/weeks/4/">SQL, Models, and Migrations</a></li>
  <li><a href="https://cs50.harvard.edu/web/2020/weeks/5/">JavaScript</a></li>
  <li><a href="https://cs50.harvard.edu/web/2020/weeks/6/">User Interfaces</a></li>
  <li><a href="https://cs50.harvard.edu/web/2020/weeks/7/">Testing, CI/CD</a></li>
  <li><a href="https://cs50.harvard.edu/web/2020/weeks/8/">Scalability and Security</a></li>
</ol>

<hr>

<ul class="fa-ul">
  <li data-marker="*"><span class="fa-li"><i class="fas fa-square"></i></span><a href="https://cs50.harvard.edu/web/2020/honesty/">Academic Honesty</a></li>
  <li data-marker="*"><span class="fa-li"><i class="fas fa-square"></i></span><a href="https://cs50.harvard.edu/web/2020/certificate/">CS50 Certificate</a></li>
  <li data-marker="*"><span class="fa-li"><i class="fas fa-square"></i></span><a href="https://cs50.harvard.edu/web/2020/faqs/">FAQs</a></li>
  <li data-marker="*"><span class="fa-li"><i class="fas fa-square"></i></span><a href="https://cs50.me/cs50w">Gradebook</a></li>
</ul>

<hr>

<ul class="fa-ul">
  <li data-marker="*"><span class="fa-li"><i class="fas fa-square"></i></span><a href="https://cs50.edx.org/ed">Ed Discussion</a> for Q&amp;A</li>
  <li data-marker="*" class="small"><span class="fa-li"><i class="fas fa-square"></i></span><a href="https://us.edstem.org/quickstart/ed-discussion.pdf">Quick Start Guide</a></li>
</ul>

<hr>

<ul class="small fa-ul">
  <li data-marker="*"><span class="fa-li"><i class="fas fa-square"></i></span><a href="https://cs50.edx.org/web">edX</a></li>
  <li data-marker="*"><span class="fa-li"><i class="fas fa-square"></i></span><a href="https://itunes.apple.com/us/course/id1505432709">iTunes U</a></li>
  <li data-marker="*"><span class="fa-li"><i class="fas fa-square"></i></span><a href="https://www.youtube.com/playlist?list=PLhQjrBD2T380xvFSUmToMMzERZ3qB5Ueu">YouTube</a></li>
</ul>

<hr>

<ul class="small fa-ul">
  <li data-marker="*"><span class="fa-li"><i class="fas fa-square"></i></span><a href="https://cs50.noticeable.news/">Changelog</a></li>
  <li data-marker="*"><span class="fa-li"><i class="fas fa-square"></i></span><a href="https://cs50.statuspage.io/">Status Page</a></li>
</ul>

<hr>

<ul class="fa-ul">
  <li data-marker="*"><span class="fa-li"><i class="fas fa-square"></i></span><a href="https://cs50.harvard.edu/web/2020/communities/"><strong>Communities</strong></a></li>
  <li data-marker="*" class="small"><span class="fa-li"><i class="fas fa-square"></i></span><a href="https://www.clubhouse.com/club/cs50">Clubhouse</a></li>
  <li data-marker="*" class="small"><span class="fa-li"><i class="fas fa-square"></i></span><a href="https://discord.gg/cs50">Discord</a> <span class="badge bg-light ms-1 py-1 rounded-pill text-dark">Q&amp;A</span></li>
  <li data-marker="*" class="small"><span class="fa-li"><i class="fas fa-square"></i></span><a href="https://cs50.edx.org/ed">Ed</a> <span class="badge bg-light ms-1 py-1 rounded-pill text-dark">Q&amp;A</span></li>
  <li data-marker="*" class="small"><span class="fa-li"><i class="fas fa-square"></i></span><a href="https://www.facebook.com/groups/cs50/">Facebook Group</a> <span class="badge bg-light ms-1 py-1 rounded-pill text-dark">Q&amp;A</span></li>
  <li data-marker="*" class="small"><span class="fa-li"><i class="fas fa-square"></i></span><a href="https://www.facebook.com/cs50/">Facebook Page</a></li>
  <li data-marker="*" class="small"><span class="fa-li"><i class="fas fa-square"></i></span><a href="https://github.com/cs50">GitHub</a></li>
  <li data-marker="*" class="small"><span class="fa-li"><i class="fas fa-square"></i></span><a href="https://gitter.im/cs50/x">Gitter</a> <span class="badge bg-light ms-1 py-1 rounded-pill text-dark">Q&amp;A</span></li>
  <li data-marker="*" class="small"><span class="fa-li"><i class="fas fa-square"></i></span><a href="https://instagram.com/cs50">Instagram</a></li>
  <li data-marker="*" class="small"><span class="fa-li"><i class="fas fa-square"></i></span><a href="https://www.linkedin.com/groups/7437240/">LinkedIn Group</a></li>
  <li data-marker="*" class="small"><span class="fa-li"><i class="fas fa-square"></i></span><a href="https://www.linkedin.com/school/CS50/">LinkedIn Page</a></li>
  <li data-marker="*" class="small"><span class="fa-li"><i class="fas fa-square"></i></span><a href="https://cs50.medium.com/">Medium</a></li>
  <li data-marker="*" class="small"><span class="fa-li"><i class="fas fa-square"></i></span><a href="https://www.quora.com/topic/CS50">Quora</a></li>
  <li data-marker="*" class="small"><span class="fa-li"><i class="fas fa-square"></i></span><a href="https://www.reddit.com/r/cs50/">Reddit</a> <span class="badge bg-light ms-1 py-1 rounded-pill text-dark">Q&amp;A</span></li>
  <li data-marker="*" class="small"><span class="fa-li"><i class="fas fa-square"></i></span><a href="https://cs50.edx.org/slack">Slack</a> <span class="badge bg-light ms-1 py-1 rounded-pill text-dark">Q&amp;A</span></li>
  <li data-marker="*" class="small"><span class="fa-li"><i class="fas fa-square"></i></span><a href="https://www.snapchat.com/add/cs50">Snapchat</a></li>
  <li data-marker="*" class="small"><span class="fa-li"><i class="fas fa-square"></i></span><a href="https://soundcloud.com/cs50">SoundCloud</a></li>
  <li data-marker="*" class="small"><span class="fa-li"><i class="fas fa-square"></i></span><a href="https://cs50.stackexchange.com/">Stack Exchange</a> <span class="badge bg-light ms-1 py-1 rounded-pill text-dark">Q&amp;A</span></li>
  <li data-marker="*" class="small"><span class="fa-li"><i class="fas fa-square"></i></span><a href="https://www.tiktok.com/@cs50">TikTok</a></li>
  <li data-marker="*" class="small"><span class="fa-li"><i class="fas fa-square"></i></span><a href="https://twitter.com/cs50">Twitter</a></li>
  <li data-marker="*" class="small"><span class="fa-li"><i class="fas fa-square"></i></span><a href="http://www.youtube.com/subscription_center?add_user=cs50tv">YouTube</a></li>
</ul>

<hr>

<p><a href="https://cs50.harvardshop.com/"><img src="Lecture%204%20-%20CS50's%20Web%20Programming%20with%20Python%20and%20JavaScript_files/GGMdcKt.png" alt="Harvard Shop"></a></p>

<hr>

<p><a href="https://cs50.harvard.edu/web/2020/license/" class="small"><i class="fab fa-creative-commons me-1"></i>License</a></p></nav>

                    <footer></footer>

                </aside>

                <main class="col-md" style="margin-bottom: 0px; margin-top: 81.3333px;">

                    <a data-id="" id="lecture-4" style="top: -81.3333px;"></a><h1 class="no_toc"><a data-id="" href="#lecture-4">Lecture 4</a></h1>

<ul id="markdown-toc">
  <li><a href="#introduction" id="markdown-toc-introduction">Introduction</a></li>
  <li><a href="#sql" id="markdown-toc-sql">SQL</a>    <ul>
      <li><a href="#databases" id="markdown-toc-databases">Databases</a></li>
      <li><a href="#column-types" id="markdown-toc-column-types">Column Types</a></li>
    </ul>
  </li>
  <li><a href="#tables" id="markdown-toc-tables">Tables</a></li>
  <li><a href="#select" id="markdown-toc-select">SELECT</a>    <ul>
      <li><a href="#working-with-sql-in-the-terminal" id="markdown-toc-working-with-sql-in-the-terminal">Working with SQL in the Terminal</a></li>
      <li><a href="#functions" id="markdown-toc-functions">Functions</a></li>
      <li><a href="#update" id="markdown-toc-update">UPDATE</a></li>
      <li><a href="#delete" id="markdown-toc-delete">DELETE</a></li>
      <li><a href="#other-clauses" id="markdown-toc-other-clauses">Other Clauses</a></li>
    </ul>
  </li>
  <li><a href="#joining-tables" id="markdown-toc-joining-tables">Joining Tables</a>    <ul>
      <li><a href="#join-query" id="markdown-toc-join-query">JOIN Query</a></li>
      <li><a href="#indexing" id="markdown-toc-indexing">Indexing:</a></li>
      <li><a href="#sql-vulnerabilities" id="markdown-toc-sql-vulnerabilities">SQL Vulnerabilities</a></li>
    </ul>
  </li>
  <li><a href="#django-models" id="markdown-toc-django-models">Django Models</a></li>
  <li><a href="#migrations" id="markdown-toc-migrations">Migrations</a></li>
  <li><a href="#shell" id="markdown-toc-shell">Shell</a>    <ul>
      <li><a href="#starting-our-application" id="markdown-toc-starting-our-application">Starting our application</a></li>
    </ul>
  </li>
  <li><a href="#django-admin" id="markdown-toc-django-admin">Django Admin</a></li>
  <li><a href="#many-to-many-relationships" id="markdown-toc-many-to-many-relationships">Many-to-Many Relationships</a></li>
  <li><a href="#users" id="markdown-toc-users">Users</a></li>
</ul>

<a data-id="" id="introduction" style="top: -81.3333px;"></a><h2><a data-id="" href="#introduction">Introduction</a></h2>

<ul class="fa-ul">
  <li data-marker="*"><span class="fa-li"><i class="fas fa-square"></i></span>So
 far, we’ve discussed how to build simple web pages using HTML and CSS, 
and how to use Git and GitHub in order to keep track of changes to our 
code and collaborate with others. We also familiarized ourselves with 
the Python programming language, and started using Django to create web 
applications.</li>
  <li data-marker="*"><span class="fa-li"><i class="fas fa-square"></i></span>Today, we’ll learn about using SQL and Django models to efficiently store and access data.</li>
</ul>

<a data-id="" id="sql" style="top: -81.3333px;"></a><h2><a data-id="" href="#sql">SQL</a></h2>

<p>: <a href="https://www.w3schools.com/sql/">SQL</a>, or Structured Query Language, is a programming language that allows us to update and query databases.</p>

<p><img src="Lecture%204%20-%20CS50's%20Web%20Programming%20with%20Python%20and%20JavaScript_files/sql.png" alt="SQL logo"></p>

<a data-id="" id="databases" style="top: -81.3333px;"></a><h3><a data-id="" href="#databases">Databases</a></h3>

<p>Before we get into how to use the SQL language, we should discuss how our data is stored. When using SQL, we’ll work with a <a href="https://www.oracle.com/database/what-is-a-relational-database/#:~:text=A%20relational%20database%20is%20a,of%20representing%20data%20in%20tables.">relational database</a> where we can find all of our data stored in a number of <a href="https://www.essentialsql.com/what-is-a-database-table/">tables</a>. Each of these tables is made up of a set number of columns and a flexible number of rows.</p>

<p>To illustrate how to work with SQL, we’ll use the example of a 
website for an airline used to keep track of flights and passengers. In 
the following table, we see that we’re keeping track of a number of 
flights, each of which has an <code class="language-plaintext highlighter-rouge">origin</code>, a <code class="language-plaintext highlighter-rouge">destination</code>, and a <code class="language-plaintext highlighter-rouge">duration</code>.</p>

<p><img src="Lecture%204%20-%20CS50's%20Web%20Programming%20with%20Python%20and%20JavaScript_files/flights0.png" alt="Flights 0"></p>

<p>There are several different relational database management systems 
that are commonly used to store information, and that can easily 
interact with SQL commands:</p>
<ul class="fa-ul">
  <li data-marker="*"><span class="fa-li"><i class="fas fa-square"></i></span><a href="https://www.mysql.com/">MySQL</a></li>
  <li data-marker="*"><span class="fa-li"><i class="fas fa-square"></i></span><a href="https://www.postgresql.org/">PostgreSQL</a></li>
  <li data-marker="*"><span class="fa-li"><i class="fas fa-square"></i></span><a href="https://www.sqlite.org/index.html">SQLite</a></li>
  <li data-marker="*"><span class="fa-li"><i class="fas fa-square"></i></span>…</li>
</ul>

<p>The first two, MySQL and PostgreSQL, are heavier-duty database 
management systems that are typically run on servers separate from those
 running a website. SQLite, on the other hand, is a lighter-weight 
system that can store all of its data in a single file. We’ll be using 
SQLite throughout this course, as it is the default system used by 
Django.</p>

<a data-id="" id="column-types" style="top: -81.3333px;"></a><h3><a data-id="" href="#column-types">Column Types</a></h3>

<p>Just as we worked with several different variable types in Python, SQLite has <a href="https://www.sqlite.org/datatype3.html">types</a>
 that represent different forms of information. Other management systems
 may have different data types, but all are fairly similar to those of 
SQLite:</p>
<ul class="fa-ul">
  <li data-marker="*"><span class="fa-li"><i class="fas fa-square"></i></span><code class="language-plaintext highlighter-rouge">TEXT</code>: For strings of text (Ex. a person’s name)</li>
  <li data-marker="*"><span class="fa-li"><i class="fas fa-square"></i></span><code class="language-plaintext highlighter-rouge">NUMERIC</code>: A more general form of numeric data (Ex. A date or boolean value)</li>
  <li data-marker="*"><span class="fa-li"><i class="fas fa-square"></i></span><code class="language-plaintext highlighter-rouge">INTEGER</code>: Any non-decimal number (Ex. a person’s age)</li>
  <li data-marker="*"><span class="fa-li"><i class="fas fa-square"></i></span><code class="language-plaintext highlighter-rouge">REAL</code>: Any real number (Ex. a person’s weight)</li>
  <li data-marker="*"><span class="fa-li"><i class="fas fa-square"></i></span><code class="language-plaintext highlighter-rouge">BLOB</code> (Binary Large Object): Any other binary data that we may want to store in our database (Ex. an image)</li>
</ul>

<a data-id="" id="tables" style="top: -81.3333px;"></a><h2><a data-id="" href="#tables">Tables</a></h2>

<p>Now, to actually get started with using SQL to interact with a database, let’s begin by creating a new table. The <a href="https://www.w3schools.com/sql/sql_create_table.asp">command to create a new table</a> looks something like this:</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">CREATE</span> <span class="k">TABLE</span> <span class="n">flights</span><span class="p">(</span>
    <span class="n">id</span> <span class="nb">INTEGER</span> <span class="k">PRIMARY</span> <span class="k">KEY</span> <span class="n">AUTOINCREMENT</span><span class="p">,</span>
    <span class="n">origin</span> <span class="nb">TEXT</span> <span class="k">NOT</span> <span class="k">NULL</span><span class="p">,</span>
    <span class="n">destination</span> <span class="nb">TEXT</span> <span class="k">NOT</span> <span class="k">NULL</span><span class="p">,</span>
    <span class="n">duration</span> <span class="nb">INTEGER</span> <span class="k">NOT</span> <span class="k">NULL</span>
<span class="p">);</span>
</code></pre></div></div>

<p>In the above command, we’re creating a new table that we’ve decided to call <code class="language-plaintext highlighter-rouge">flights</code>, and we’ve added four columns to this table:</p>
<ol>
  <li><code class="language-plaintext highlighter-rouge">id</code>: It is often helpful to have an number that allows us to uniquely identify each row in a table. Here we have specified that <code class="language-plaintext highlighter-rouge">id</code> is an integer, and also that it is our <a href="https://www.w3schools.com/sql/sql_primarykey.ASP">primary key</a>, meaning it is our unique identifier. We have additionally specified that it will <code class="language-plaintext highlighter-rouge">AUTOINCREMENT</code>, which means we will not have to provide an id every time we add to the table because it will be done automatically.</li>
  <li><code class="language-plaintext highlighter-rouge">origin</code>: Here we’ve specified that this will be a text field, and by writing <code class="language-plaintext highlighter-rouge">NOT NULL</code> we have required that it have a value.</li>
  <li><code class="language-plaintext highlighter-rouge">destination</code>: Again we’ve specified that this will be a text field and prevented it from being null.</li>
  <li><code class="language-plaintext highlighter-rouge">duration</code>: Again this value cannot be null, but this time it is represented by an integer rather than as text.</li>
</ol>

<p>We just saw the <code class="language-plaintext highlighter-rouge">NOT NULL</code> and <code class="language-plaintext highlighter-rouge">PRIMARY KEY</code> constraint when making a column, but there are several other <a href="https://www.tutorialspoint.com/sqlite/sqlite_constraints.htm">constraints</a> available to us:</p>
<ul class="fa-ul">
  <li data-marker="*"><span class="fa-li"><i class="fas fa-square"></i></span><code class="language-plaintext highlighter-rouge">CHECK</code>: Makes sure certain constraints are met before allowing a row to be added/modified</li>
  <li data-marker="*"><span class="fa-li"><i class="fas fa-square"></i></span><code class="language-plaintext highlighter-rouge">DEFAULT</code>: Provides a default value if no value is given</li>
  <li data-marker="*"><span class="fa-li"><i class="fas fa-square"></i></span><code class="language-plaintext highlighter-rouge">NOT NULL</code>: Makes sure a value is provided</li>
  <li data-marker="*"><span class="fa-li"><i class="fas fa-square"></i></span><code class="language-plaintext highlighter-rouge">PRIMARY KEY</code>: Indicates this is the primary way of searching for a row in the database</li>
  <li data-marker="*"><span class="fa-li"><i class="fas fa-square"></i></span><code class="language-plaintext highlighter-rouge">UNIQUE</code>: Ensures that no two rows have the same value in that column.</li>
  <li data-marker="*"><span class="fa-li"><i class="fas fa-square"></i></span>…</li>
</ul>

<p>Now that we’ve seen how to create a table, let’s look at how we can add rows to it. In SQL, we do this using the <code class="language-plaintext highlighter-rouge">INSERT</code> command:</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">INSERT</span> <span class="k">INTO</span> <span class="n">flights</span>
    <span class="p">(</span><span class="n">origin</span><span class="p">,</span> <span class="n">destination</span><span class="p">,</span> <span class="n">duration</span><span class="p">)</span>
    <span class="k">VALUES</span> <span class="p">(</span><span class="nv">"New York"</span><span class="p">,</span> <span class="nv">"London"</span><span class="p">,</span> <span class="mi">415</span><span class="p">);</span>
</code></pre></div></div>

<p>In the above command, we’ve specified the table name we wish to 
insert into, then provided a list of the column names we will be 
providing information on, and then specified the <code class="language-plaintext highlighter-rouge">VALUES</code> we would like to fill that row in the table, making sure the <code class="language-plaintext highlighter-rouge">VALUES</code> come in the same order as our corresponding list of columns. Note that we don’t need to provide a value for <code class="language-plaintext highlighter-rouge">id</code> because it is automatically incrementing.</p>

<a data-id="" id="select" style="top: -81.3333px;"></a><h2><a data-id="" href="#select">SELECT</a></h2>

<p>Once a table has been populated with some rows, we’ll probably want a
 way to access data within that table. We do this using SQL’s <a href="https://www.w3schools.com/sql/sql_select.asp">SELECT</a> query. The simplest <code class="language-plaintext highlighter-rouge">SELECT</code> query into our flights table might look something like this:</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">flights</span><span class="p">;</span>
</code></pre></div></div>

<p>The above command (*) retrieves all of the data from our flights table</p>

<p><img src="Lecture%204%20-%20CS50's%20Web%20Programming%20with%20Python%20and%20JavaScript_files/all.png" alt="all"></p>

<p>It may be the case though that we don’t really need all of the 
columns from the database, just origin and destination. To access just 
these columns, we can replace the * with the column names we would like 
access to. The following query returns all of the origins and 
destinations.</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span> <span class="n">origin</span><span class="p">,</span> <span class="n">destination</span> <span class="k">FROM</span> <span class="n">flights</span><span class="p">;</span>
</code></pre></div></div>

<p><img src="Lecture%204%20-%20CS50's%20Web%20Programming%20with%20Python%20and%20JavaScript_files/flights1.png" alt="Just two cols"></p>

<p>As our tables get larger and larger, we will also want to narrow down which rows our query returns. We do this by adding a <a href="https://www.w3schools.com/sql/sql_where.asp">WHERE</a> followed by some condition. For example, the following command selects only row with an <code class="language-plaintext highlighter-rouge">id</code> of <code class="language-plaintext highlighter-rouge">3</code>:</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">flights</span> <span class="k">WHERE</span> <span class="n">id</span> <span class="o">=</span> <span class="mi">3</span><span class="p">;</span>
</code></pre></div></div>

<p><img src="Lecture%204%20-%20CS50's%20Web%20Programming%20with%20Python%20and%20JavaScript_files/where0.png" alt="only one row"></p>

<p>e can filter  by any column, not just <code class="language-plaintext highlighter-rouge">id</code>!</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">flights</span> <span class="k">WHERE</span> <span class="n">origin</span> <span class="o">=</span> <span class="nv">"New York"</span><span class="p">;</span>
</code></pre></div></div>

<p><img src="Lecture%204%20-%20CS50's%20Web%20Programming%20with%20Python%20and%20JavaScript_files/where1.png" alt="Origin is New York"></p>

<a data-id="" id="working-with-sql-in-the-terminal" style="top: -81.3333px;"></a><h3><a data-id="" href="#working-with-sql-in-the-terminal">Working with SQL in the Terminal</a></h3>

<p>Now that we know some basic SQL commands, let’s test them out in the 
terminal! In order to work with SQLite on your computer, you must first <a href="https://www.sqlite.org/download.html">download SQLite</a>. (We won’t use it in lecture, but you can also <a href="https://sqlitebrowser.org/dl/">download DB Browser</a> for a more user-friendly way to run SQL queries.)</p>

<p>We can start by creating a file for our database either by manually creating a new file, or running <code class="language-plaintext highlighter-rouge">touch flights.sql</code> in the terminal. Now, if we run <code class="language-plaintext highlighter-rouge">sqlite3 flights.sql</code> in the terminal, we’ll be brought to a SQLite prompt where we can run SQL commands:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="c"># Entering into the SQLite Prompt</span>
<span class="o">(</span>base<span class="o">)</span> % sqlite3 flights.sql
SQLite version 3.26.0 2018-12-01 12:34:55
Enter <span class="s2">".help"</span> <span class="k">for </span>usage hints.

<span class="c"># Creating a new Table</span>
sqlite&gt; CREATE TABLE flights<span class="o">(</span>
   ...&gt;     <span class="nb">id </span>INTEGER PRIMARY KEY AUTOINCREMENT,
   ...&gt;     origin TEXT NOT NULL,
   ...&gt;     destination TEXT NOT NULL,
   ...&gt;     duration INTEGER NOT NULL
   ...&gt; <span class="o">)</span><span class="p">;</span>

<span class="c"># Listing all current tables (Just flights for now)</span>
sqlite&gt; .tables
flights

<span class="c"># Querying for everything within flights (Which is now empty)</span>
sqlite&gt; SELECT <span class="k">*</span> FROM flights<span class="p">;</span>

<span class="c"># Adding one flight</span>
sqlite&gt; INSERT INTO flights
   ...&gt;     <span class="o">(</span>origin, destination, duration<span class="o">)</span>
   ...&gt;     VALUES <span class="o">(</span><span class="s2">"New York"</span>, <span class="s2">"London"</span>, 415<span class="o">)</span><span class="p">;</span>

<span class="c"># Checking for new information, which we can now see</span>
sqlite&gt; SELECT <span class="k">*</span> FROM flights<span class="p">;</span>
1|New York|London|415

<span class="c"># Adding some more flights</span>
sqlite&gt; INSERT INTO flights <span class="o">(</span>origin, destination, duration<span class="o">)</span> VALUES <span class="o">(</span><span class="s2">"Shanghai"</span>, <span class="s2">"Paris"</span>, 760<span class="o">)</span><span class="p">;</span>
sqlite&gt; INSERT INTO flights <span class="o">(</span>origin, destination, duration<span class="o">)</span> VALUES <span class="o">(</span><span class="s2">"Istanbul"</span>, <span class="s2">"Tokyo"</span>, 700<span class="o">)</span><span class="p">;</span>
sqlite&gt; INSERT INTO flights <span class="o">(</span>origin, destination, duration<span class="o">)</span> VALUES <span class="o">(</span><span class="s2">"New York"</span>, <span class="s2">"Paris"</span>, 435<span class="o">)</span><span class="p">;</span>
sqlite&gt; INSERT INTO flights <span class="o">(</span>origin, destination, duration<span class="o">)</span> VALUES <span class="o">(</span><span class="s2">"Moscow"</span>, <span class="s2">"Paris"</span>, 245<span class="o">)</span><span class="p">;</span>
sqlite&gt; INSERT INTO flights <span class="o">(</span>origin, destination, duration<span class="o">)</span> VALUES <span class="o">(</span><span class="s2">"Lima"</span>, <span class="s2">"New York"</span>, 455<span class="o">)</span><span class="p">;</span>

<span class="c"># Querying this new information</span>
sqlite&gt; SELECT <span class="k">*</span> FROM flights<span class="p">;</span>
1|New York|London|415
2|Shanghai|Paris|760
3|Istanbul|Tokyo|700
4|New York|Paris|435
5|Moscow|Paris|245
6|Lima|New York|455

<span class="c"># Changing the settings to make output more readable</span>
sqlite&gt; .mode columns
sqlite&gt; .headers <span class="nb">yes</span>

<span class="c"># Querying all information again</span>
sqlite&gt; SELECT <span class="k">*</span> FROM flights<span class="p">;</span>
<span class="nb">id          </span>origin      destination  duration
<span class="nt">----------</span>  <span class="nt">----------</span>  <span class="nt">-----------</span>  <span class="nt">----------</span>
1           New York    London       415
2           Shanghai    Paris        760
3           Istanbul    Tokyo        700
4           New York    Paris        435
5           Moscow      Paris        245
6           Lima        New York     455

<span class="c"># Searching for just those flights originating in New York</span>
sqlite&gt; SELECT <span class="k">*</span> FROM flights WHERE origin <span class="o">=</span> <span class="s2">"New York"</span><span class="p">;</span>
<span class="nb">id          </span>origin      destination  duration
<span class="nt">----------</span>  <span class="nt">----------</span>  <span class="nt">-----------</span>  <span class="nt">----------</span>
1           New York    London       415
4           New York    Paris        435
</code></pre></div></div>

<p>We can also use more than just equality to filter out our flights. 
For integer and real values, we can use greater than or less than:</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">flights</span> <span class="k">WHERE</span> <span class="n">duration</span> <span class="o">&gt;</span> <span class="mi">500</span><span class="p">;</span>
</code></pre></div></div>

<p><img src="Lecture%204%20-%20CS50's%20Web%20Programming%20with%20Python%20and%20JavaScript_files/500.png" alt="&gt; 500"></p>

<p>And we can also use other logic (<a href="https://www.w3schools.com/sql/sql_and_or.asp">AND, OR</a>) like in Python:</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">flights</span> <span class="k">WHERE</span> <span class="n">duration</span> <span class="o">&gt;</span> <span class="mi">500</span> <span class="k">AND</span> <span class="n">destination</span> <span class="o">=</span> <span class="nv">"Paris"</span><span class="p">;</span>
</code></pre></div></div>

<p><img src="Lecture%204%20-%20CS50's%20Web%20Programming%20with%20Python%20and%20JavaScript_files/500andparis.png" alt="&gt; 500 and paris"></p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">flights</span> <span class="k">WHERE</span> <span class="n">duration</span> <span class="o">&gt;</span> <span class="mi">500</span> <span class="k">OR</span> <span class="n">destination</span> <span class="o">=</span> <span class="nv">"Paris"</span><span class="p">;</span>
</code></pre></div></div>

<p><img src="Lecture%204%20-%20CS50's%20Web%20Programming%20with%20Python%20and%20JavaScript_files/500orparis.png" alt="&gt; 500 or paris"></p>

<p>We can also use the keyword <a href="https://www.w3schools.com/sql/sql_in.asp">IN</a> to see if a bit of data is one of several options:</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">flights</span> <span class="k">WHERE</span> <span class="n">origin</span> <span class="k">IN</span> <span class="p">(</span><span class="nv">"New York"</span><span class="p">,</span> <span class="nv">"Lima"</span><span class="p">);</span>
</code></pre></div></div>

<p><img src="Lecture%204%20-%20CS50's%20Web%20Programming%20with%20Python%20and%20JavaScript_files/in.png" alt="in"></p>

<p>We can even use regular expressions to search words more broadly using the <a href="https://www.w3schools.com/sql/sql_like.asp">LIKE</a> keyword. The below query finds all results with an <code class="language-plaintext highlighter-rouge">a</code> in the origin, by using <code class="language-plaintext highlighter-rouge">%</code> as a wildcard character.</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">flights</span> <span class="k">WHERE</span> <span class="n">origin</span> <span class="k">LIKE</span> <span class="nv">"%a%"</span><span class="p">;</span>
</code></pre></div></div>

<p><img src="Lecture%204%20-%20CS50's%20Web%20Programming%20with%20Python%20and%20JavaScript_files/like.png" alt="Origin has an 'a'"></p>

<a data-id="" id="functions" style="top: -81.3333px;"></a><h3><a data-id="" href="#functions">Functions</a></h3>

<p>There are also a number of SQL functions we can apply to the results 
of a query. These can be useful if we don’t need all of the data 
returned by a query, but just some summary statistics of the data.</p>
<ul class="fa-ul">
  <li data-marker="*"><span class="fa-li"><i class="fas fa-square"></i></span><a href="https://www.w3schools.com/sql/sql_count_avg_sum.asp">AVERAGE</a></li>
  <li data-marker="*"><span class="fa-li"><i class="fas fa-square"></i></span><a href="https://www.w3schools.com/sql/sql_count_avg_sum.asp">COUNT</a></li>
  <li data-marker="*"><span class="fa-li"><i class="fas fa-square"></i></span><a href="https://www.w3schools.com/sql/sql_min_max.asp">MAX</a></li>
  <li data-marker="*"><span class="fa-li"><i class="fas fa-square"></i></span><a href="https://www.w3schools.com/sql/sql_min_max.asp">MIN</a></li>
  <li data-marker="*"><span class="fa-li"><i class="fas fa-square"></i></span><a href="https://www.w3schools.com/sql/sql_count_avg_sum.asp">SUM</a></li>
  <li data-marker="*"><span class="fa-li"><i class="fas fa-square"></i></span>…</li>
</ul>

<a data-id="" id="update" style="top: -81.3333px;"></a><h3><a data-id="" href="#update">UPDATE</a></h3>

<p>We’ve now seen how to add to and search tables, but we may also want 
to be able update rows of a table that already exist. We do this using 
the <a href="https://www.w3schools.com/sql/sql_update.asp">UPDATE</a> 
command as shown below. As you may have guessed by reading this out 
loud, the command finds any flights that go from New York to London, and
 then sets their durations to 430.</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">UPDATE</span> <span class="n">flights</span>
    <span class="k">SET</span> <span class="n">duration</span> <span class="o">=</span> <span class="mi">430</span>
    <span class="k">WHERE</span> <span class="n">origin</span> <span class="o">=</span> <span class="nv">"New York"</span>
    <span class="k">AND</span> <span class="n">destination</span> <span class="o">=</span> <span class="nv">"London"</span><span class="p">;</span>
</code></pre></div></div>

<a data-id="" id="delete" style="top: -81.3333px;"></a><h3><a data-id="" href="#delete">DELETE</a></h3>

<p>We also might want the ability to delete rows from our database, and we can do this using the <a href="https://www.w3schools.com/sql/sql_delete.asp">DELETE</a> command. The following code will remove all flights that land in Tokyo:</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">DELETE</span> <span class="k">FROM</span> <span class="n">flights</span> <span class="k">WHERE</span> <span class="n">destination</span> <span class="o">=</span> <span class="nv">"Tokyo"</span><span class="p">;</span>
</code></pre></div></div>

<a data-id="" id="other-clauses" style="top: -81.3333px;"></a><h3><a data-id="" href="#other-clauses">Other Clauses</a></h3>

<p>There are a number of additional clauses we can use to control queries coming back to us</p>
<ul class="fa-ul">
  <li data-marker="*"><span class="fa-li"><i class="fas fa-square"></i></span><a href="https://www.w3schools.com/sql/sql_top.asp">LIMIT</a>: Limits the number of results returned by a query</li>
  <li data-marker="*"><span class="fa-li"><i class="fas fa-square"></i></span><a href="https://www.w3schools.com/sql/sql_orderby.asp">ORDER BY</a>: Orders the results based on a specified column</li>
  <li data-marker="*"><span class="fa-li"><i class="fas fa-square"></i></span><a href="https://www.w3schools.com/sql/sql_groupby.asp">GROUP BY</a>: Groups results by a specified column</li>
  <li data-marker="*"><span class="fa-li"><i class="fas fa-square"></i></span><a href="https://www.w3schools.com/sql/sql_having.asp">HAVING</a>: Allows for additional constraints based on the number of results</li>
</ul>

<a data-id="" id="joining-tables" style="top: -81.3333px;"></a><h2><a data-id="" href="#joining-tables">Joining Tables</a></h2>

<p>So far, we’ve only been working with one table at a time, but many 
databases in practice are populated by a number of tables that all 
relate to each other in some way. In our flights example, let’s imagine 
we also want to add an airport code to go with the city. The way our 
table is currently set up, we would have to add two more columns to go 
with each row. We would also be repeating information, as we would have 
to write in multiple places that city X is associated with code Y.</p>

<p>One way we can solve this problem is by deciding to have one table 
that keeps track of flights, and then another table keeping track of 
airports. The second table might look something like this</p>

<p><img src="Lecture%204%20-%20CS50's%20Web%20Programming%20with%20Python%20and%20JavaScript_files/airports.png" alt="Airport Table"></p>

<p>Now we have a table relating codes and cities, rather than storing an
 entire city name in our flights table, it will save storage space if 
we’re able to just save the <code class="language-plaintext highlighter-rouge">id</code> of that airport. Therefore, we should rewrite the flights table accordingly. Since we’re using the <code class="language-plaintext highlighter-rouge">id</code> column of the airports table to populate <code class="language-plaintext highlighter-rouge">origin_id</code> and <code class="language-plaintext highlighter-rouge">destination_id</code>, we call those values <a href="https://www.w3schools.com/sql/sql_foreignkey.asp">Foreign Keys</a></p>

<p><img src="Lecture%204%20-%20CS50's%20Web%20Programming%20with%20Python%20and%20JavaScript_files/flights2.png" alt="New Flights"></p>

<p>In addition to flights and airports, an airline might also want to 
store data about its passengers, like which flight each passenger will 
be on. Using the power of relational databases, we can add another table
 that stores first and last names, and a foreign key representing the 
flight they are on</p>

<p><img src="Lecture%204%20-%20CS50's%20Web%20Programming%20with%20Python%20and%20JavaScript_files/simple_pass.png" alt="Simple Passengers Table"></p>

<p>We can do even better than this though, as the same person may be on more than one flight. To account for this, we can create a <code class="language-plaintext highlighter-rouge">people</code> table that stores first and last names, and a <code class="language-plaintext highlighter-rouge">passengers</code> table that pairs people with flights</p>

<p><img src="Lecture%204%20-%20CS50's%20Web%20Programming%20with%20Python%20and%20JavaScript_files/people.png" alt="People"></p>

<p><img src="Lecture%204%20-%20CS50's%20Web%20Programming%20with%20Python%20and%20JavaScript_files/passengers.png" alt="Passengers"></p>

<p>ecause in this case a single person can be on many flights and a 
single flight can have many people, we call the relationship between <code class="language-plaintext highlighter-rouge">flights</code> and <code class="language-plaintext highlighter-rouge">people</code> a <strong>Many to Many</strong> relationship. The <code class="language-plaintext highlighter-rouge">passengers</code> table that connects the two is known as an <strong>association table</strong>.</p>

<a data-id="" id="join-query" style="top: -81.3333px;"></a><h3><a data-id="" href="#join-query">JOIN Query</a></h3>

<p>Although our data is now more efficiently stored, it seems like it may be harder to query our data. Thankfully, SQL has a <a href="https://www.w3schools.com/sql/sql_join.asp">JOIN</a> query where we can combine two tables for the purposes of another query.</p>

<p>For example, let’s say we want to find the origin, destination, and 
first name of every trip a passenger is taking. Also for simplicity in 
this table, we’re going to be using the unoptimized <code class="language-plaintext highlighter-rouge">passengers</code> table that includes the flight id, first name, and last name. The first part of this query looks fairly familiar:</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span> <span class="k">first</span><span class="p">,</span> <span class="n">origin</span><span class="p">,</span> <span class="n">destination</span>
<span class="k">FROM</span> <span class="p">...</span>
</code></pre></div></div>

<p>But we run into a problem here because <code class="language-plaintext highlighter-rouge">first</code> is stored in the <code class="language-plaintext highlighter-rouge">passengers</code> table, while <code class="language-plaintext highlighter-rouge">origin</code> and <code class="language-plaintext highlighter-rouge">destination</code> are stored in the <code class="language-plaintext highlighter-rouge">flights</code> table. We solve this by joining the two tables using the fact that <code class="language-plaintext highlighter-rouge">flight_id</code> in the <code class="language-plaintext highlighter-rouge">passengers</code> table corresponds to <code class="language-plaintext highlighter-rouge">id</code> in the <code class="language-plaintext highlighter-rouge">flights</code> table:</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span> <span class="k">first</span><span class="p">,</span> <span class="n">origin</span><span class="p">,</span> <span class="n">destination</span>
<span class="k">FROM</span> <span class="n">flights</span> <span class="k">JOIN</span> <span class="n">passengers</span>
<span class="k">ON</span> <span class="n">passengers</span><span class="p">.</span><span class="n">flight_id</span> <span class="o">=</span> <span class="n">flights</span><span class="p">.</span><span class="n">id</span><span class="p">;</span>
</code></pre></div></div>

<p><img src="Lecture%204%20-%20CS50's%20Web%20Programming%20with%20Python%20and%20JavaScript_files/join.png" alt="Join blurry"></p>

<p>We’ve just used something called an <a href="https://www.w3schools.com/sql/sql_join_inner.asp">INNER JOIN</a>, which means we are ignoring rows that have no matches between the tables, but there are other types of joins, including <a href="https://www.w3schools.com/sql/sql_join_left.asp"><strong>LEFT JOIN</strong>s</a>, <a href="https://www.w3schools.com/sql/sql_join_right.asp"><strong>RIGHT JOIN</strong>s</a>, and <a href="https://www.w3schools.com/sql/sql_join_full.asp"><strong>FULL OUTER JOIN</strong>s</a>, which we won’t discuss here in detail.</p>

<a data-id="" id="indexing" style="top: -81.3333px;"></a><h3><a data-id="" href="#indexing">Indexing:</a></h3>

<p>One way we can make our queries more efficient when dealing with 
large tables is to create an index similar to the index you might see in
 the back of a textbook. For example, if we know that we’ll often look 
up passengers by their last name, we could create an index from last 
name to id using the command:</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">CREATE</span> <span class="k">INDEX</span> <span class="n">name_index</span> <span class="k">ON</span> <span class="n">passengers</span> <span class="p">(</span><span class="k">last</span><span class="p">);</span>
</code></pre></div></div>

<a data-id="" id="sql-vulnerabilities" style="top: -81.3333px;"></a><h3><a data-id="" href="#sql-vulnerabilities">SQL Vulnerabilities</a></h3>

<dl>
  <dt>Now that we know the basics of using SQL to work with data, it’s 
important to point out the main vulnerabilities associated with using 
SQL. We’ll start with <a href="https://www.w3schools.com/sql/sql_injection.asp">SQL Injection</a>.</dt>
  <dd>
    <p>A SQL injection attack is when a malicious user enters SQL code 
as input on a site in order to bypass the sites security measures. For 
example, let’s say we have a table storing usernames and passwords, and 
then a login form on the home site of a page. We may search for the user
 using a query such as:</p>
  </dd>
</dl>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">users</span>
<span class="k">WHERE</span> <span class="n">username</span> <span class="o">=</span> <span class="n">username</span> <span class="k">AND</span> <span class="n">password</span> <span class="o">=</span> <span class="n">password</span><span class="p">;</span>
</code></pre></div></div>

<p>A user named Harry might go to this site and type <code class="language-plaintext highlighter-rouge">harry</code> as a username and <code class="language-plaintext highlighter-rouge">12345</code> as a password, in which case the query would look like this:</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">users</span>
<span class="k">WHERE</span> <span class="n">username</span> <span class="o">=</span> <span class="nv">"harry"</span> <span class="k">AND</span> <span class="n">password</span> <span class="o">=</span> <span class="nv">"12345"</span><span class="p">;</span>
</code></pre></div></div>

<p>A hacker, on the other hand, might type <code class="language-plaintext highlighter-rouge">harry" --</code> as a username and nothing as a password. It turns out that <code class="language-plaintext highlighter-rouge">--</code> stands for a comment in SQL, meaning the query would look like:</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">users</span>
<span class="k">WHERE</span> <span class="n">username</span> <span class="o">=</span> <span class="nv">"harry"</span><span class="c1">--" AND password = "12345";</span>
</code></pre></div></div>

<p>Because in this query the password checking has been commented out, 
the hacker can log into Harry’s account without knowing their password. 
To solve this problem, we can use:</p>
<ul class="fa-ul">
  <li data-marker="*"><span class="fa-li"><i class="fas fa-square"></i></span>Escape characters to make sure SQL treats the input as plain text and not as SQL code.</li>
  <li data-marker="*"><span class="fa-li"><i class="fas fa-square"></i></span>An abstraction layer on top of SQL which includes its own escape sequence, so we don’t have to write SQL queries ourselves.</li>
</ul>

<dl>
  <dt>The other main vulnerability when it comes to SQL is known as a <a href="https://searchstorage.techtarget.com/definition/race-condition#:~:text=A%20race%20condition%20is%20an,sequence%20to%20be%20done%20correctly.">Race Condition</a>.</dt>
  <dd>
    <p>A race condition is a situation that occurs when multiple queries
 to a database occur simultaneously. When these are not adequately 
handled, problems can arise in the precise times that databases are 
updated. For example, let’s say I have $150 in my bank account. A race 
condition could occur if I log into my bank account on both my phone and
 my laptop, and attempt to withdraw $100 on each device. If the bank’s 
software developers did not deal with race conditions correctly, then I 
may be able to withdraw $200 from an account with only $150 in it. One 
potential solution for this problem would be locking the database. We 
could not allow any other interaction with the database until one 
transaction has been completed. In the bank example, after clicking 
navigating to the “Make a Withdrawl” page on my computer, the bank might
 not allow me to navigate to that page on my phone.</p>
  </dd>
</dl>

<a data-id="" id="django-models" style="top: -81.3333px;"></a><h2><a data-id="" href="#django-models">Django Models</a></h2>

<p>: <a href="https://docs.djangoproject.com/en/3.0/topics/db/models/">Django Models</a> are a level of <a href="https://techterms.com/definition/abstraction">abstraction</a> on top of SQL that allow us to work with databases using Python classes and objects rather than direct SQL queries.</p>

<p>Let’s get started on using models by creating a django project for our airline, and creating an app within that project.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>django-admin startproject airline
<span class="nb">cd </span>airline
python manage.py startapp flights
</code></pre></div></div>

<p>Now we’ll have to go through the process of adding an app as usual:</p>
<ol>
  <li>Add <code class="language-plaintext highlighter-rouge">flights</code> to the <code class="language-plaintext highlighter-rouge">INSTALLED_APPS</code> list in <code class="language-plaintext highlighter-rouge">settings.py</code></li>
  <li>
    <p>Add a route for <code class="language-plaintext highlighter-rouge">flights</code> in <code class="language-plaintext highlighter-rouge">urls.py</code>:</p>

    <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code> <span class="n">path</span><span class="p">(</span><span class="s">"flights/"</span><span class="p">,</span> <span class="n">include</span><span class="p">(</span><span class="s">"flights.urls"</span><span class="p">)),</span>
</code></pre></div>    </div>
  </li>
  <li>Create a <code class="language-plaintext highlighter-rouge">urls.py</code> file within the <code class="language-plaintext highlighter-rouge">flights</code> application. And fill it with standard <code class="language-plaintext highlighter-rouge">urls.py</code> imports and lists.</li>
</ol>

<p>Now, rather than creating actual paths and getting started on <code class="language-plaintext highlighter-rouge">views.py</code>, we’ll create some models in the <code class="language-plaintext highlighter-rouge">models.py</code>
 file. In this file, we’ll outline what data we want to store in our 
application. Then, Django will determine the SQL syntax necessary to 
store information on each of our models. Let’s take a look at what a 
model for a single flight might look like:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">Flight</span><span class="p">(</span><span class="n">models</span><span class="p">.</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">origin</span> <span class="o">=</span> <span class="n">models</span><span class="p">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">64</span><span class="p">)</span>
    <span class="n">destination</span> <span class="o">=</span> <span class="n">models</span><span class="p">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">64</span><span class="p">)</span>
    <span class="n">duration</span> <span class="o">=</span> <span class="n">models</span><span class="p">.</span><span class="n">IntegerField</span><span class="p">()</span>
</code></pre></div></div>

<p>Let’s take a look at what’s going on in this model definition:</p>
<ul class="fa-ul">
  <li data-marker="*"><span class="fa-li"><i class="fas fa-square"></i></span>In the first line, we create a new model that <strong>extends</strong> Django’s model class.</li>
  <li data-marker="*"><span class="fa-li"><i class="fas fa-square"></i></span>Below, we add fields for origin, destination, and duration. The first two are <a href="https://docs.djangoproject.com/en/3.0/ref/forms/fields/#charfield">Char Fields</a>, meaning they store strings, and the third is an <a href="https://docs.djangoproject.com/en/3.0/ref/forms/fields/#integerfield">Integer Field</a>. These are just two of many <a href="https://docs.djangoproject.com/en/3.0/ref/forms/fields/#built-in-field-classes">built-in Django Field classes</a></li>
  <li data-marker="*"><span class="fa-li"><i class="fas fa-square"></i></span>We
 specify maximum lengths of 64 for the two Character Fields. you can 
check the specifications available for a given field by checking the <a href="https://docs.djangoproject.com/en/3.0/ref/forms/fields/#built-in-field-classes">documentation</a>.</li>
</ul>

<a data-id="" id="migrations" style="top: -81.3333px;"></a><h2><a data-id="" href="#migrations">Migrations</a></h2>

<p>Now, even though we’ve created a model, we do not yet have a database
 to store this information. to create a database from our models, we 
navigate to the main directory of our project and run the command.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>python manage.py makemigrations
</code></pre></div></div>

<p>This command creates some Python files that will create or edit our 
database to be able to store what we have in our models. You should get 
an output that looks something like the one below, and if you navigate 
to your <code class="language-plaintext highlighter-rouge">migrations</code> directory, you’ll notice a new file was created for us</p>

<p><img src="Lecture%204%20-%20CS50's%20Web%20Programming%20with%20Python%20and%20JavaScript_files/migration0.png" alt="migrations output 0"></p>

<p>Next, to apply these migrations to our database, we run the command</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>python manage.py migrate
</code></pre></div></div>

<p>Now, you’ll see some default migrations have been applied along with 
our own, and you’ll also notice that we now have a file called <code class="language-plaintext highlighter-rouge">db.sqlite3</code> in our project’s directory</p>

<p><img src="Lecture%204%20-%20CS50's%20Web%20Programming%20with%20Python%20and%20JavaScript_files/migration1.png" alt="migrate output"></p>

<a data-id="" id="shell" style="top: -81.3333px;"></a><h2><a data-id="" href="#shell">Shell</a></h2>

<p>Now, to begin working adding information to and manipulating this 
database, we can enter Django’s shell where we can run Python commands 
within our project.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>python manage.py shell
Python 3.7.2 <span class="o">(</span>default, Dec 29 2018, 00:00:04<span class="o">)</span>
Type <span class="s1">'copyright'</span>, <span class="s1">'credits'</span> or <span class="s1">'license'</span> <span class="k">for </span>more information
IPython 6.5.0 <span class="nt">--</span> An enhanced Interactive Python. Type <span class="s1">'?'</span> <span class="k">for </span>help.
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Import our flight model
</span><span class="n">In</span> <span class="p">[</span><span class="mi">1</span><span class="p">]:</span> <span class="kn">from</span> <span class="nn">flights.models</span> <span class="kn">import</span> <span class="n">Flight</span>

<span class="c1"># Create a new flight
</span><span class="n">In</span> <span class="p">[</span><span class="mi">2</span><span class="p">]:</span> <span class="n">f</span> <span class="o">=</span> <span class="n">Flight</span><span class="p">(</span><span class="n">origin</span><span class="o">=</span><span class="s">"New York"</span><span class="p">,</span> <span class="n">destination</span><span class="o">=</span><span class="s">"London"</span><span class="p">,</span> <span class="n">duration</span><span class="o">=</span><span class="mi">415</span><span class="p">)</span>

<span class="c1"># Instert that flight into our database
</span><span class="n">In</span> <span class="p">[</span><span class="mi">3</span><span class="p">]:</span> <span class="n">f</span><span class="p">.</span><span class="n">save</span><span class="p">()</span>

<span class="c1"># Query for all flights stored in the database
</span><span class="n">In</span> <span class="p">[</span><span class="mi">4</span><span class="p">]:</span> <span class="n">Flight</span><span class="p">.</span><span class="n">objects</span><span class="p">.</span><span class="nb">all</span><span class="p">()</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">4</span><span class="p">]:</span> <span class="o">&lt;</span><span class="n">QuerySet</span> <span class="p">[</span><span class="o">&lt;</span><span class="n">Flight</span><span class="p">:</span> <span class="n">Flight</span> <span class="nb">object</span> <span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">&gt;</span><span class="p">]</span><span class="o">&gt;</span>
</code></pre></div></div>

<p>When we query our database, we see that we get just one flight called <code class="language-plaintext highlighter-rouge">Flight object (1)</code>. This isn’t a very informative name, but we can fix that. Inside <code class="language-plaintext highlighter-rouge">models.py</code>, we’ll define a <code class="language-plaintext highlighter-rouge">__str__</code> function that provides instructions for how to turn a Flight object into a string:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">Flight</span><span class="p">(</span><span class="n">models</span><span class="p">.</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">origin</span> <span class="o">=</span> <span class="n">models</span><span class="p">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">64</span><span class="p">)</span>
    <span class="n">destination</span> <span class="o">=</span> <span class="n">models</span><span class="p">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">64</span><span class="p">)</span>
    <span class="n">duration</span> <span class="o">=</span> <span class="n">models</span><span class="p">.</span><span class="n">IntegerField</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s">"</span><span class="si">{</span><span class="bp">self</span><span class="p">.</span><span class="nb">id</span><span class="si">}</span><span class="s">: </span><span class="si">{</span><span class="bp">self</span><span class="p">.</span><span class="n">origin</span><span class="si">}</span><span class="s"> to </span><span class="si">{</span><span class="bp">self</span><span class="p">.</span><span class="n">destination</span><span class="si">}</span><span class="s">"</span>
</code></pre></div></div>

<p>Now, when we go back to the shell, our output is a bit more readable:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Create a variable called flights to store the results of a query
</span><span class="n">In</span> <span class="p">[</span><span class="mi">7</span><span class="p">]:</span> <span class="n">flights</span> <span class="o">=</span> <span class="n">Flight</span><span class="p">.</span><span class="n">objects</span><span class="p">.</span><span class="nb">all</span><span class="p">()</span>

<span class="c1"># Displaying all flights
</span><span class="n">In</span> <span class="p">[</span><span class="mi">8</span><span class="p">]:</span> <span class="n">flights</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">8</span><span class="p">]:</span> <span class="o">&lt;</span><span class="n">QuerySet</span> <span class="p">[</span><span class="o">&lt;</span><span class="n">Flight</span><span class="p">:</span> <span class="mi">1</span><span class="p">:</span> <span class="n">New</span> <span class="n">York</span> <span class="n">to</span> <span class="n">London</span><span class="o">&gt;</span><span class="p">]</span><span class="o">&gt;</span>

<span class="c1"># Isolating just the first flight
</span><span class="n">In</span> <span class="p">[</span><span class="mi">9</span><span class="p">]:</span> <span class="n">flight</span> <span class="o">=</span> <span class="n">flights</span><span class="p">.</span><span class="n">first</span><span class="p">()</span>

<span class="c1"># Printing flight information
</span><span class="n">In</span> <span class="p">[</span><span class="mi">10</span><span class="p">]:</span> <span class="n">flight</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">10</span><span class="p">]:</span> <span class="o">&lt;</span><span class="n">Flight</span><span class="p">:</span> <span class="mi">1</span><span class="p">:</span> <span class="n">New</span> <span class="n">York</span> <span class="n">to</span> <span class="n">London</span><span class="o">&gt;</span>

<span class="c1"># Display flight id
</span><span class="n">In</span> <span class="p">[</span><span class="mi">11</span><span class="p">]:</span> <span class="n">flight</span><span class="p">.</span><span class="nb">id</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">11</span><span class="p">]:</span> <span class="mi">1</span>

<span class="c1"># Display flight origin
</span><span class="n">In</span> <span class="p">[</span><span class="mi">12</span><span class="p">]:</span> <span class="n">flight</span><span class="p">.</span><span class="n">origin</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">12</span><span class="p">]:</span> <span class="s">'New York'</span>

<span class="c1"># Display flight destination
</span><span class="n">In</span> <span class="p">[</span><span class="mi">13</span><span class="p">]:</span> <span class="n">flight</span><span class="p">.</span><span class="n">destination</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">13</span><span class="p">]:</span> <span class="s">'London'</span>

<span class="c1"># Display flight duration
</span><span class="n">In</span> <span class="p">[</span><span class="mi">14</span><span class="p">]:</span> <span class="n">flight</span><span class="p">.</span><span class="n">duration</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">14</span><span class="p">]:</span> <span class="mi">415</span>
</code></pre></div></div>

<p>This is a good start, but thinking back to earlier, we don’t want to 
have to store the city name as an origin and destination for every 
flight, so we probably want another model for an airport that is somehow
 related to the flight model:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">Airport</span><span class="p">(</span><span class="n">models</span><span class="p">.</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">code</span> <span class="o">=</span> <span class="n">models</span><span class="p">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">city</span> <span class="o">=</span> <span class="n">models</span><span class="p">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">64</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s">"</span><span class="si">{</span><span class="bp">self</span><span class="p">.</span><span class="n">city</span><span class="si">}</span><span class="s"> (</span><span class="si">{</span><span class="bp">self</span><span class="p">.</span><span class="n">code</span><span class="si">}</span><span class="s">)"</span>

<span class="k">class</span> <span class="nc">Flight</span><span class="p">(</span><span class="n">models</span><span class="p">.</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">origin</span> <span class="o">=</span> <span class="n">models</span><span class="p">.</span><span class="n">ForeignKey</span><span class="p">(</span><span class="n">Airport</span><span class="p">,</span> <span class="n">on_delete</span><span class="o">=</span><span class="n">models</span><span class="p">.</span><span class="n">CASCADE</span><span class="p">,</span> <span class="n">related_name</span><span class="o">=</span><span class="s">"departures"</span><span class="p">)</span>
    <span class="n">destination</span> <span class="o">=</span> <span class="n">models</span><span class="p">.</span><span class="n">ForeignKey</span><span class="p">(</span><span class="n">Airport</span><span class="p">,</span> <span class="n">on_delete</span><span class="o">=</span><span class="n">models</span><span class="p">.</span><span class="n">CASCADE</span><span class="p">,</span> <span class="n">related_name</span><span class="o">=</span><span class="s">"arrivals"</span><span class="p">)</span>
    <span class="n">duration</span> <span class="o">=</span> <span class="n">models</span><span class="p">.</span><span class="n">IntegerField</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s">"</span><span class="si">{</span><span class="bp">self</span><span class="p">.</span><span class="nb">id</span><span class="si">}</span><span class="s">: </span><span class="si">{</span><span class="bp">self</span><span class="p">.</span><span class="n">origin</span><span class="si">}</span><span class="s"> to </span><span class="si">{</span><span class="bp">self</span><span class="p">.</span><span class="n">destination</span><span class="si">}</span><span class="s">"</span>
</code></pre></div></div>

<p>We’ve seen everything in our new <code class="language-plaintext highlighter-rouge">Airport</code> class before, but the changes to the <code class="language-plaintext highlighter-rouge">origin</code> and <code class="language-plaintext highlighter-rouge">destination</code> fields within the <code class="language-plaintext highlighter-rouge">Flight</code> class are new to us:</p>
<ul class="fa-ul">
  <li data-marker="*"><span class="fa-li"><i class="fas fa-square"></i></span>We specify that the <code class="language-plaintext highlighter-rouge">origin</code> and <code class="language-plaintext highlighter-rouge">destination</code> fields are each <a href="https://docs.djangoproject.com/en/3.0/topics/db/examples/many_to_one/">Foreign Keys</a>, which means they refer to another object.</li>
  <li data-marker="*"><span class="fa-li"><i class="fas fa-square"></i></span>By entering <code class="language-plaintext highlighter-rouge">Airport</code> as our first argument, we are specifying the type of object this field refers to.</li>
  <li data-marker="*"><span class="fa-li"><i class="fas fa-square"></i></span>The next argument, <code class="language-plaintext highlighter-rouge">on_delete=models.CASCADE</code>
 gives instructions for what should happen if an airport is deleted. In 
this case, we specify that when an airport is deleted, all flights 
associated with it should also be deleted. There are <a href="https://docs.djangoproject.com/en/3.0/ref/models/fields/#django.db.models.ForeignKey.on_delete">several other options</a> in addition to <code class="language-plaintext highlighter-rouge">CASCADE</code>.</li>
  <li data-marker="*"><span class="fa-li"><i class="fas fa-square"></i></span>We provide a <a href="https://docs.djangoproject.com/en/3.0/ref/models/fields/#django.db.models.ForeignKey.related_name">related name</a>, which gives us a way to search for all flights with a given airport as their origin or destination.</li>
</ul>

<p>Every time we make changes in <code class="language-plaintext highlighter-rouge">models.py</code>,
 we have to make migrations and then migrate. Note that you may have to 
delete your existing flight from New York to London, as it doesn’t fit 
in with the new database structure.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Create New Migrations</span>
python manage.py makemigration

<span class="c"># Migrate</span>
python manage.py migrate
</code></pre></div></div>

<p>Now, let’s try these new models out in the Django shell:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Import all models
</span><span class="n">In</span> <span class="p">[</span><span class="mi">1</span><span class="p">]:</span> <span class="kn">from</span> <span class="nn">flights.models</span> <span class="kn">import</span> <span class="o">*</span>

<span class="c1"># Create some new airports
</span><span class="n">In</span> <span class="p">[</span><span class="mi">2</span><span class="p">]:</span> <span class="n">jfk</span> <span class="o">=</span> <span class="n">Airport</span><span class="p">(</span><span class="n">code</span><span class="o">=</span><span class="s">"JFK"</span><span class="p">,</span> <span class="n">city</span><span class="o">=</span><span class="s">"New York"</span><span class="p">)</span>
<span class="n">In</span> <span class="p">[</span><span class="mi">4</span><span class="p">]:</span> <span class="n">lhr</span> <span class="o">=</span> <span class="n">Airport</span><span class="p">(</span><span class="n">code</span><span class="o">=</span><span class="s">"LHR"</span><span class="p">,</span> <span class="n">city</span><span class="o">=</span><span class="s">"London"</span><span class="p">)</span>
<span class="n">In</span> <span class="p">[</span><span class="mi">6</span><span class="p">]:</span> <span class="n">cdg</span> <span class="o">=</span> <span class="n">Airport</span><span class="p">(</span><span class="n">code</span><span class="o">=</span><span class="s">"CDG"</span><span class="p">,</span> <span class="n">city</span><span class="o">=</span><span class="s">"Paris"</span><span class="p">)</span>
<span class="n">In</span> <span class="p">[</span><span class="mi">9</span><span class="p">]:</span> <span class="n">nrt</span> <span class="o">=</span> <span class="n">Airport</span><span class="p">(</span><span class="n">code</span><span class="o">=</span><span class="s">"NRT"</span><span class="p">,</span> <span class="n">city</span><span class="o">=</span><span class="s">"Tokyo"</span><span class="p">)</span>

<span class="c1"># Save the airports to the database
</span><span class="n">In</span> <span class="p">[</span><span class="mi">3</span><span class="p">]:</span> <span class="n">jfk</span><span class="p">.</span><span class="n">save</span><span class="p">()</span>
<span class="n">In</span> <span class="p">[</span><span class="mi">5</span><span class="p">]:</span> <span class="n">lhr</span><span class="p">.</span><span class="n">save</span><span class="p">()</span>
<span class="n">In</span> <span class="p">[</span><span class="mi">8</span><span class="p">]:</span> <span class="n">cdg</span><span class="p">.</span><span class="n">save</span><span class="p">()</span>
<span class="n">In</span> <span class="p">[</span><span class="mi">10</span><span class="p">]:</span> <span class="n">nrt</span><span class="p">.</span><span class="n">save</span><span class="p">()</span>

<span class="c1"># Add a flight and save it to the database
</span><span class="n">f</span> <span class="o">=</span> <span class="n">Flight</span><span class="p">(</span><span class="n">origin</span><span class="o">=</span><span class="n">jfk</span><span class="p">,</span> <span class="n">destination</span><span class="o">=</span><span class="n">lhr</span><span class="p">,</span> <span class="n">duration</span><span class="o">=</span><span class="mi">414</span><span class="p">)</span>
<span class="n">f</span><span class="p">.</span><span class="n">save</span><span class="p">()</span>

<span class="c1"># Display some info about the flight
</span><span class="n">In</span> <span class="p">[</span><span class="mi">14</span><span class="p">]:</span> <span class="n">f</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">14</span><span class="p">]:</span> <span class="o">&lt;</span><span class="n">Flight</span><span class="p">:</span> <span class="mi">1</span><span class="p">:</span> <span class="n">New</span> <span class="n">York</span> <span class="p">(</span><span class="n">JFK</span><span class="p">)</span> <span class="n">to</span> <span class="n">London</span> <span class="p">(</span><span class="n">LHR</span><span class="p">)</span><span class="o">&gt;</span>
<span class="n">In</span> <span class="p">[</span><span class="mi">15</span><span class="p">]:</span> <span class="n">f</span><span class="p">.</span><span class="n">origin</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">15</span><span class="p">]:</span> <span class="o">&lt;</span><span class="n">Airport</span><span class="p">:</span> <span class="n">New</span> <span class="n">York</span> <span class="p">(</span><span class="n">JFK</span><span class="p">)</span><span class="o">&gt;</span>

<span class="c1"># Using the related name to query by airport of arrival:
</span><span class="n">In</span> <span class="p">[</span><span class="mi">17</span><span class="p">]:</span> <span class="n">lhr</span><span class="p">.</span><span class="n">arrivals</span><span class="p">.</span><span class="nb">all</span><span class="p">()</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">17</span><span class="p">]:</span> <span class="o">&lt;</span><span class="n">QuerySet</span> <span class="p">[</span><span class="o">&lt;</span><span class="n">Flight</span><span class="p">:</span> <span class="mi">1</span><span class="p">:</span> <span class="n">New</span> <span class="n">York</span> <span class="p">(</span><span class="n">JFK</span><span class="p">)</span> <span class="n">to</span> <span class="n">London</span> <span class="p">(</span><span class="n">LHR</span><span class="p">)</span><span class="o">&gt;</span><span class="p">]</span><span class="o">&gt;</span>
</code></pre></div></div>

<a data-id="" id="starting-our-application" style="top: -81.3333px;"></a><h3><a data-id="" href="#starting-our-application">Starting our application</a></h3>

<p>We can now begin to build an application around this process of using
 models to interact with a database. Let’s begin by creating an index 
route for our airline. Inside <code class="language-plaintext highlighter-rouge">urls.py</code>:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">urlpatterns</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">path</span><span class="p">(</span><span class="s">''</span><span class="p">,</span> <span class="n">views</span><span class="p">.</span><span class="n">index</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s">"index"</span><span class="p">),</span>
<span class="p">]</span>
</code></pre></div></div>

<p>Inside <code class="language-plaintext highlighter-rouge">views.py</code>:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">django.shortcuts</span> <span class="kn">import</span> <span class="n">render</span>
<span class="kn">from</span> <span class="nn">.models</span> <span class="kn">import</span> <span class="n">Flight</span><span class="p">,</span> <span class="n">Airport</span>

<span class="c1"># Create your views here.
</span>
<span class="k">def</span> <span class="nf">index</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">render</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="s">"flights/index.html"</span><span class="p">,</span> <span class="p">{</span>
        <span class="s">"flights"</span><span class="p">:</span> <span class="n">Flight</span><span class="p">.</span><span class="n">objects</span><span class="p">.</span><span class="nb">all</span><span class="p">()</span>
    <span class="p">})</span>
</code></pre></div></div>

<p>Inside our new <code class="language-plaintext highlighter-rouge">layout.html</code> file:</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="nt">&lt;html</span> <span class="na">lang=</span><span class="s">"en"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;head&gt;</span>
        <span class="nt">&lt;title&gt;</span>Flights<span class="nt">&lt;/title&gt;</span>
    <span class="nt">&lt;/head&gt;</span>
    <span class="nt">&lt;body&gt;</span>
        {% block body %}
        {% endblock %}
    <span class="nt">&lt;/body&gt;</span>
<span class="nt">&lt;/html&gt;</span>

</code></pre></div></div>

<p>Inside a new <code class="language-plaintext highlighter-rouge">index.html</code> file:</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
{% extends "flights/layout.html" %}

{% block body %}
    <span class="nt">&lt;h1&gt;</span>Flights:<span class="nt">&lt;/h1&gt;</span>
    <span class="nt">&lt;ul&gt;</span>
        {% for flight in flights %}
            <span class="nt">&lt;li&gt;</span>Flight {{ flight.id }}: {{ flight.origin }} to {{ flight.destination }}<span class="nt">&lt;/li&gt;</span>
        {% endfor %}
    <span class="nt">&lt;/ul&gt;</span>
{% endblock %}

</code></pre></div></div>

<p>What we’ve done here is created a default page where we have a list 
of all flights we’ve created so far. When we open up the page now, it 
looks like this</p>

<p><img src="Lecture%204%20-%20CS50's%20Web%20Programming%20with%20Python%20and%20JavaScript_files/flightspage0.png" alt="Just one on the list"></p>

<p>Now, let’s add some more flights to our application by returning to the Django shell:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Using the filter command to find all airports based in New York
</span><span class="n">In</span> <span class="p">[</span><span class="mi">3</span><span class="p">]:</span> <span class="n">Airport</span><span class="p">.</span><span class="n">objects</span><span class="p">.</span><span class="nb">filter</span><span class="p">(</span><span class="n">city</span><span class="o">=</span><span class="s">"New York"</span><span class="p">)</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">3</span><span class="p">]:</span> <span class="o">&lt;</span><span class="n">QuerySet</span> <span class="p">[</span><span class="o">&lt;</span><span class="n">Airport</span><span class="p">:</span> <span class="n">New</span> <span class="n">York</span> <span class="p">(</span><span class="n">JFK</span><span class="p">)</span><span class="o">&gt;</span><span class="p">]</span><span class="o">&gt;</span>

<span class="c1"># Using the get command to get only one airport in New York
</span><span class="n">In</span> <span class="p">[</span><span class="mi">5</span><span class="p">]:</span> <span class="n">Airport</span><span class="p">.</span><span class="n">objects</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">city</span><span class="o">=</span><span class="s">"New York"</span><span class="p">)</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">5</span><span class="p">]:</span> <span class="o">&lt;</span><span class="n">Airport</span><span class="p">:</span> <span class="n">New</span> <span class="n">York</span> <span class="p">(</span><span class="n">JFK</span><span class="p">)</span><span class="o">&gt;</span>

<span class="c1"># Assigning some airports to variable names:
</span><span class="n">In</span> <span class="p">[</span><span class="mi">6</span><span class="p">]:</span> <span class="n">jfk</span> <span class="o">=</span> <span class="n">Airport</span><span class="p">.</span><span class="n">objects</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">city</span><span class="o">=</span><span class="s">"New York"</span><span class="p">)</span>
<span class="n">In</span> <span class="p">[</span><span class="mi">7</span><span class="p">]:</span> <span class="n">cdg</span> <span class="o">=</span> <span class="n">Airport</span><span class="p">.</span><span class="n">objects</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">city</span><span class="o">=</span><span class="s">"Paris"</span><span class="p">)</span>

<span class="c1"># Creating and saving a new flight:
</span><span class="n">In</span> <span class="p">[</span><span class="mi">8</span><span class="p">]:</span> <span class="n">f</span> <span class="o">=</span> <span class="n">Flight</span><span class="p">(</span><span class="n">origin</span><span class="o">=</span><span class="n">jfk</span><span class="p">,</span> <span class="n">destination</span><span class="o">=</span><span class="n">cdg</span><span class="p">,</span> <span class="n">duration</span><span class="o">=</span><span class="mi">435</span><span class="p">)</span>
<span class="n">In</span> <span class="p">[</span><span class="mi">9</span><span class="p">]:</span> <span class="n">f</span><span class="p">.</span><span class="n">save</span><span class="p">()</span>
</code></pre></div></div>

<p>Now, when we visit our site again</p>

<p><img src="Lecture%204%20-%20CS50's%20Web%20Programming%20with%20Python%20and%20JavaScript_files/flightpage1.png" alt="Two flights"></p>

<a data-id="" id="django-admin" style="top: -81.3333px;"></a><h2><a data-id="" href="#django-admin">Django Admin</a></h2>

<p>Since it is so common for developers to have to create new objects like we’ve been doing in the shell, Django comes with a <a href="https://docs.djangoproject.com/en/3.0/ref/contrib/admin/">default admin interface</a> that allows us to do this more easily. To begin using this tool, we must first create an administrative user:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">(</span>base<span class="o">)</span> cleggett@Connors-MacBook-Pro airline % python manage.py createsuperuser
Username: user_a
Email address: a@a.com
Password:
Password <span class="o">(</span>again<span class="o">)</span>:
Superuser created successfully.
</code></pre></div></div>

<p>Now, we must add our models to the admin application by entering the <code class="language-plaintext highlighter-rouge">admin.py</code>
 file within our app, and importing and registering our models. This 
tells Django which models we would like to have access to in the admin 
app.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">django.contrib</span> <span class="kn">import</span> <span class="n">admin</span>
<span class="kn">from</span> <span class="nn">.models</span> <span class="kn">import</span> <span class="n">Flight</span><span class="p">,</span> <span class="n">Airport</span>

<span class="c1"># Register your models here.
</span><span class="n">admin</span><span class="p">.</span><span class="n">site</span><span class="p">.</span><span class="n">register</span><span class="p">(</span><span class="n">Flight</span><span class="p">)</span>
<span class="n">admin</span><span class="p">.</span><span class="n">site</span><span class="p">.</span><span class="n">register</span><span class="p">(</span><span class="n">Airport</span><span class="p">)</span>
</code></pre></div></div>

<p>Now, when we visit our site and add <code class="language-plaintext highlighter-rouge">/admin</code> to the url, we can log into a page that looks like this</p>

<p><img src="Lecture%204%20-%20CS50's%20Web%20Programming%20with%20Python%20and%20JavaScript_files/login.png" alt="login"></p>

<p>After loggin in, you’ll be brought to a page like the one below where
 you can create, edit, and delete objects stored in the database</p>

<p><img src="Lecture%204%20-%20CS50's%20Web%20Programming%20with%20Python%20and%20JavaScript_files/admin.png" alt="admin page"></p>

<p>Now, let’s add a few more pages to our site. We’ll begin by adding 
the ability to click on a flight to get more information about it. To do
 this, let’s create a URL path that includes the <code class="language-plaintext highlighter-rouge">id</code> of a flight:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">path</span><span class="p">(</span><span class="s">"&lt;int:flight_id&gt;"</span><span class="p">,</span> <span class="n">views</span><span class="p">.</span><span class="n">flight</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s">"flight"</span><span class="p">)</span>
</code></pre></div></div>

<p>Then, in <code class="language-plaintext highlighter-rouge">views.py</code> we will create a <code class="language-plaintext highlighter-rouge">flight</code> function that takes in a flight id and renders a new html page:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">flight</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">flight_id</span><span class="p">):</span>
    <span class="n">flight</span> <span class="o">=</span> <span class="n">Flight</span><span class="p">.</span><span class="n">objects</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">flight_id</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">render</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="s">"flights/flight.html"</span><span class="p">,</span> <span class="p">{</span>
        <span class="s">"flight"</span><span class="p">:</span> <span class="n">flight</span>
    <span class="p">})</span>
</code></pre></div></div>

<p>Now we’ll create a template to display this flight information with a link back to the home page</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
{% extends "flights/layout.html" %}

{% block body %}
    <span class="nt">&lt;h1&gt;</span>Flight {{ flight.id }}<span class="nt">&lt;/h1&gt;</span>
    <span class="nt">&lt;ul&gt;</span>
        <span class="nt">&lt;li&gt;</span>Origin: {{ flight.origin }}<span class="nt">&lt;/li&gt;</span>
        <span class="nt">&lt;li&gt;</span>Destination: {{ flight.destination }}<span class="nt">&lt;/li&gt;</span>
        <span class="nt">&lt;li&gt;</span>Duration: {{ flight.duration }} minutes<span class="nt">&lt;/li&gt;</span>
    <span class="nt">&lt;/ul&gt;</span>
    <span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">"{% url 'index' %}"</span><span class="nt">&gt;</span>All Flights<span class="nt">&lt;/a&gt;</span>
{% endblock %}

</code></pre></div></div>

<p>Finally, we need to add the ability to link from one page to another, so we’ll modify our index page to include links:</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
{% extends "flights/layout.html" %}

{% block body %}
    <span class="nt">&lt;h1&gt;</span>Flights:<span class="nt">&lt;/h1&gt;</span>
    <span class="nt">&lt;ul&gt;</span>
        {% for flight in flights %}
            <span class="nt">&lt;li&gt;&lt;a</span> <span class="na">href=</span><span class="s">"{% url 'flight' flight.id %}"</span><span class="nt">&gt;</span>Flight {{ flight.id }}<span class="nt">&lt;/a&gt;</span>: {{ flight.origin }} to {{ flight.destination }}<span class="nt">&lt;/li&gt;</span>
        {% endfor %}
    <span class="nt">&lt;/ul&gt;</span>
{% endblock %}

</code></pre></div></div>

<p>Now our homepage looks like this</p>

<p><img src="Lecture%204%20-%20CS50's%20Web%20Programming%20with%20Python%20and%20JavaScript_files/flights_links.png" alt="new home"></p>

<p>And when we click on flight 5, for example, we’re brought to this page</p>

<p><img src="Lecture%204%20-%20CS50's%20Web%20Programming%20with%20Python%20and%20JavaScript_files/flight5.png" alt="One flight"></p>

<a data-id="" id="many-to-many-relationships" style="top: -81.3333px;"></a><h2><a data-id="" href="#many-to-many-relationships">Many-to-Many Relationships</a></h2>

<p>Now, let’s work on integrating passengers into our models. We’ll create a passenger model to start:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">Passenger</span><span class="p">(</span><span class="n">models</span><span class="p">.</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">first</span> <span class="o">=</span> <span class="n">models</span><span class="p">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">64</span><span class="p">)</span>
    <span class="n">last</span> <span class="o">=</span> <span class="n">models</span><span class="p">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">64</span><span class="p">)</span>
    <span class="n">flights</span> <span class="o">=</span> <span class="n">models</span><span class="p">.</span><span class="n">ManyToManyField</span><span class="p">(</span><span class="n">Flight</span><span class="p">,</span> <span class="n">blank</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">related_name</span><span class="o">=</span><span class="s">"passengers"</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s">"</span><span class="si">{</span><span class="bp">self</span><span class="p">.</span><span class="n">first</span><span class="si">}</span><span class="s"> </span><span class="si">{</span><span class="bp">self</span><span class="p">.</span><span class="n">last</span><span class="si">}</span><span class="s">"</span>
</code></pre></div></div>

<ul class="fa-ul">
  <li data-marker="*"><span class="fa-li"><i class="fas fa-square"></i></span>As we discussed, passengers have a <strong>Many to Many</strong> relationship with flights, which we describe in Django using the ManyToManyField.</li>
  <li data-marker="*"><span class="fa-li"><i class="fas fa-square"></i></span>The first argument in this field is the class of objects that this one is related to.</li>
  <li data-marker="*"><span class="fa-li"><i class="fas fa-square"></i></span>We have provided the argument <code class="language-plaintext highlighter-rouge">blank=True</code> which means a passenger can have no flights</li>
  <li data-marker="*"><span class="fa-li"><i class="fas fa-square"></i></span>We have added a <code class="language-plaintext highlighter-rouge">related_name</code> that serves the same purpose as it did earlier: it will allow us to find all passengers on a given flight.</li>
</ul>

<p>To actually make these changes, we must make migrations and migrate. We can then register the Passenger model in <code class="language-plaintext highlighter-rouge">admin.py</code> and visit the admin page to create some passengers!</p>

<p>Now that we’ve added some passengers, let’s update our flight page so
 that it displays all passengers on a flight. We’ll first visit <code class="language-plaintext highlighter-rouge">views.py</code>
 and update our flight view to provide a list of passengers as context. 
We access the list using the related name we defined earlier.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">flight</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">flight_id</span><span class="p">):</span>
    <span class="n">flight</span> <span class="o">=</span> <span class="n">Flight</span><span class="p">.</span><span class="n">objects</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">flight_id</span><span class="p">)</span>
    <span class="n">passengers</span> <span class="o">=</span> <span class="n">flight</span><span class="p">.</span><span class="n">passengers</span><span class="p">.</span><span class="nb">all</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">render</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="s">"flights/flight.html"</span><span class="p">,</span> <span class="p">{</span>
        <span class="s">"flight"</span><span class="p">:</span> <span class="n">flight</span><span class="p">,</span>
        <span class="s">"passengers"</span><span class="p">:</span> <span class="n">passengers</span>
    <span class="p">})</span>
</code></pre></div></div>

<p>Now, add a list of passengers to <code class="language-plaintext highlighter-rouge">flight.html</code>:</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="nt">&lt;h2&gt;</span>Passengers:<span class="nt">&lt;/h2&gt;</span>
<span class="nt">&lt;ul&gt;</span>
    {% for passenger in passengers %}
        <span class="nt">&lt;li&gt;</span>{{ passenger }}<span class="nt">&lt;/li&gt;</span>
    {% empty %}
        <span class="nt">&lt;li&gt;</span>No Passengers.<span class="nt">&lt;/li&gt;</span>
    {% endfor %}
<span class="nt">&lt;/ul&gt;</span>

</code></pre></div></div>

<p>At this point, when we click on flight 5, we see</p>

<p><img src="Lecture%204%20-%20CS50's%20Web%20Programming%20with%20Python%20and%20JavaScript_files/flight5update.png" alt="new flight 5"></p>

<p>Now, let’s work on giving visitors to our site the ability to book a flight. We’ll do this by adding a booking route in <code class="language-plaintext highlighter-rouge">urls.py</code>:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">path</span><span class="p">(</span><span class="s">"&lt;int:flight_id&gt;/book"</span><span class="p">,</span> <span class="n">views</span><span class="p">.</span><span class="n">book</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s">"book"</span><span class="p">)</span>
</code></pre></div></div>

<p>Now, we’ll add a book function to <code class="language-plaintext highlighter-rouge">views.py</code> that adds a passenger to a flight:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">book</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">flight_id</span><span class="p">):</span>

    <span class="c1"># For a post request, add a new flight
</span>    <span class="k">if</span> <span class="n">request</span><span class="p">.</span><span class="n">method</span> <span class="o">==</span> <span class="s">"POST"</span><span class="p">:</span>

        <span class="c1"># Accessing the flight
</span>        <span class="n">flight</span> <span class="o">=</span> <span class="n">Flight</span><span class="p">.</span><span class="n">objects</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">pk</span><span class="o">=</span><span class="n">flight_id</span><span class="p">)</span>

        <span class="c1"># Finding the passenger id from the submitted form data
</span>        <span class="n">passenger_id</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">request</span><span class="p">.</span><span class="n">POST</span><span class="p">[</span><span class="s">"passenger"</span><span class="p">])</span>

        <span class="c1"># Finding the passenger based on the id
</span>        <span class="n">passenger</span> <span class="o">=</span> <span class="n">Passenger</span><span class="p">.</span><span class="n">objects</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">pk</span><span class="o">=</span><span class="n">passenger_id</span><span class="p">)</span>

        <span class="c1"># Add passenger to the flight
</span>        <span class="n">passenger</span><span class="p">.</span><span class="n">flights</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">flight</span><span class="p">)</span>

        <span class="c1"># Redirect user to flight page
</span>        <span class="k">return</span> <span class="n">HttpResponseRedirect</span><span class="p">(</span><span class="n">reverse</span><span class="p">(</span><span class="s">"flight"</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">flight</span><span class="p">.</span><span class="nb">id</span><span class="p">,)))</span>
</code></pre></div></div>

<p>Next, we’ll add some context to our flight template so that the page 
has access to everyone who is not currently a passenger on the flight 
using Django’s ability to <a href="https://docs.djangoproject.com/en/3.0/topics/db/queries/#retrieving-specific-objects-with-filters">exclude</a> certain objects from a query:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">flight</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">flight_id</span><span class="p">):</span>
    <span class="n">flight</span> <span class="o">=</span> <span class="n">Flight</span><span class="p">.</span><span class="n">objects</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">flight_id</span><span class="p">)</span>
    <span class="n">passengers</span> <span class="o">=</span> <span class="n">flight</span><span class="p">.</span><span class="n">passengers</span><span class="p">.</span><span class="nb">all</span><span class="p">()</span>
    <span class="n">non_passengers</span> <span class="o">=</span> <span class="n">Passenger</span><span class="p">.</span><span class="n">objects</span><span class="p">.</span><span class="n">exclude</span><span class="p">(</span><span class="n">flights</span><span class="o">=</span><span class="n">flight</span><span class="p">).</span><span class="nb">all</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">render</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="s">"flights/flight.html"</span><span class="p">,</span> <span class="p">{</span>
        <span class="s">"flight"</span><span class="p">:</span> <span class="n">flight</span><span class="p">,</span>
        <span class="s">"passengers"</span><span class="p">:</span> <span class="n">passengers</span><span class="p">,</span>
        <span class="s">"non_passengers"</span><span class="p">:</span> <span class="n">non_passengers</span>
    <span class="p">})</span>
</code></pre></div></div>

<p>Now, we’ll add a form to our flight page’s HTML using a select input field:</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="nt">&lt;form</span> <span class="na">action=</span><span class="s">"{% url 'book' flight.id %}"</span> <span class="na">method=</span><span class="s">"post"</span><span class="nt">&gt;</span>
    {% csrf_token %}
    <span class="nt">&lt;select</span> <span class="na">name=</span><span class="s">"passenger"</span> <span class="na">id=</span><span class="s">""</span><span class="nt">&gt;</span>
        {% for passenger in non_passengers %}
            <span class="nt">&lt;option</span> <span class="na">value=</span><span class="s">"{{ passenger.id }}"</span><span class="nt">&gt;</span>{{ passenger }}<span class="nt">&lt;/option&gt;</span>
        {% endfor %}
    <span class="nt">&lt;/select&gt;</span>
    <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"submit"</span><span class="nt">&gt;</span>
<span class="nt">&lt;/form&gt;</span>

</code></pre></div></div>

<p>Now, let’s see what the site looks like when I go to a flight page and then add a passenger</p>

<p><img src="Lecture%204%20-%20CS50's%20Web%20Programming%20with%20Python%20and%20JavaScript_files/form.png" alt="form"></p>

<p><img src="Lecture%204%20-%20CS50's%20Web%20Programming%20with%20Python%20and%20JavaScript_files/submitted.png" alt="submitted"></p>

<p>Another advantage of using the Django admin app is that it is 
customizable. For example, if we wish to see all aspects of a flight in 
the admin interface, we can create a new class within <code class="language-plaintext highlighter-rouge">admin.py</code> and add it as an argument when registering the <code class="language-plaintext highlighter-rouge">Flight</code> model:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">FlightAdmin</span><span class="p">(</span><span class="n">admin</span><span class="p">.</span><span class="n">ModelAdmin</span><span class="p">):</span>
    <span class="n">list_display</span> <span class="o">=</span> <span class="p">(</span><span class="s">"id"</span><span class="p">,</span> <span class="s">"origin"</span><span class="p">,</span> <span class="s">"destination"</span><span class="p">,</span> <span class="s">"duration"</span><span class="p">)</span>

<span class="c1"># Register your models here.
</span><span class="n">admin</span><span class="p">.</span><span class="n">site</span><span class="p">.</span><span class="n">register</span><span class="p">(</span><span class="n">Flight</span><span class="p">,</span> <span class="n">FlightAdmin</span><span class="p">)</span>
</code></pre></div></div>

<p>Now, when we visit the admin page for flights, we can see the <code class="language-plaintext highlighter-rouge">id</code> as well</p>

<p><img src="Lecture%204%20-%20CS50's%20Web%20Programming%20with%20Python%20and%20JavaScript_files/admin1.png" alt="admin table"></p>

<p>Check out <a href="https://docs.djangoproject.com/en/3.0/ref/contrib/admin/">Django’s admin documentation</a> to find more ways to customize the admin app.</p>

<a data-id="" id="users" style="top: -81.3333px;"></a><h2><a data-id="" href="#users">Users</a></h2>

<p>The last thing we’ll discuss in lecture today is the idea of 
authentication, or allowing users to log in and out of a website. 
Fortunately, Django makes this very easy for us, so let’s go through an 
example of how we would do this. We’ll start by creating a new app 
called <code class="language-plaintext highlighter-rouge">users</code>. Here we’ll go through all the normal steps of creating a new app, but in our new <code class="language-plaintext highlighter-rouge">urls.py</code> file, we’ll add a few more routes:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">urlpatterns</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">path</span><span class="p">(</span><span class="s">''</span><span class="p">,</span> <span class="n">views</span><span class="p">.</span><span class="n">index</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s">"index"</span><span class="p">),</span>
    <span class="n">path</span><span class="p">(</span><span class="s">"login"</span><span class="p">,</span> <span class="n">views</span><span class="p">.</span><span class="n">login_view</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s">"login"</span><span class="p">),</span>
    <span class="n">path</span><span class="p">(</span><span class="s">"logout"</span><span class="p">,</span> <span class="n">views</span><span class="p">.</span><span class="n">logout_view</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s">"logout"</span><span class="p">)</span>
<span class="p">]</span>
</code></pre></div></div>

<p>Let’s begin by creating a form where a user can log in. We’ll create a <code class="language-plaintext highlighter-rouge">layout.html</code> file as always, and then create a <code class="language-plaintext highlighter-rouge">login.html</code> file which contains a form, and that displays a message if one exists.</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
{% extends "users/layout.html" %}

{% block body %}
    {% if message %}
        <span class="nt">&lt;div&gt;</span>{{ message }}<span class="nt">&lt;/div&gt;</span>
    {% endif %}

    <span class="nt">&lt;form</span> <span class="na">action=</span><span class="s">"{% url 'login' %}"</span> <span class="na">method=</span><span class="s">"post"</span><span class="nt">&gt;</span>
        {% csrf_token %}
        <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"text"</span><span class="err">,</span> <span class="na">name=</span><span class="s">"username"</span><span class="err">,</span> <span class="na">placeholder=</span><span class="s">"Username"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"password"</span><span class="err">,</span> <span class="na">name=</span><span class="s">"password"</span><span class="err">,</span> <span class="na">placeholder=</span><span class="s">"Password"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"submit"</span><span class="err">,</span> <span class="na">value=</span><span class="s">"Login"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;/form&gt;</span>
{% endblock %}

</code></pre></div></div>

<p>Now, in <code class="language-plaintext highlighter-rouge">views.py</code>, we’ll add three functions:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">index</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
    <span class="c1"># If no user is signed in, return to login page:
</span>    <span class="k">if</span> <span class="ow">not</span> <span class="n">request</span><span class="p">.</span><span class="n">user</span><span class="p">.</span><span class="n">is_authenticated</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">HttpResponseRedirect</span><span class="p">(</span><span class="n">reverse</span><span class="p">(</span><span class="s">"login"</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">render</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="s">"users/user.html"</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">login_view</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">render</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="s">"users/login.html"</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">logout_view</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
    <span class="c1"># Pass is a simple way to tell python to do nothing.
</span>    <span class="k">pass</span>
</code></pre></div></div>

<p>Next, we can head to the admin site and add some users. After doing that, we’ll go back to <code class="language-plaintext highlighter-rouge">views.py</code> and update our <code class="language-plaintext highlighter-rouge">login_view</code> function to handle a <code class="language-plaintext highlighter-rouge">POST</code> request with a username and password:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Additional imports we'll need:
</span><span class="kn">from</span> <span class="nn">django.contrib.auth</span> <span class="kn">import</span> <span class="n">authenticate</span><span class="p">,</span> <span class="n">login</span><span class="p">,</span> <span class="n">logout</span>

<span class="k">def</span> <span class="nf">login_view</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">request</span><span class="p">.</span><span class="n">method</span> <span class="o">==</span> <span class="s">"POST"</span><span class="p">:</span>
        <span class="c1"># Accessing username and password from form data
</span>        <span class="n">username</span> <span class="o">=</span> <span class="n">request</span><span class="p">.</span><span class="n">POST</span><span class="p">[</span><span class="s">"username"</span><span class="p">]</span>
        <span class="n">password</span> <span class="o">=</span> <span class="n">request</span><span class="p">.</span><span class="n">POST</span><span class="p">[</span><span class="s">"password"</span><span class="p">]</span>

        <span class="c1"># Check if username and password are correct, returning User object if so
</span>        <span class="n">user</span> <span class="o">=</span> <span class="n">authenticate</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">username</span><span class="o">=</span><span class="n">username</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="n">password</span><span class="p">)</span>

        <span class="c1"># If user object is returned, log in and route to index page:
</span>        <span class="k">if</span> <span class="n">user</span><span class="p">:</span>
            <span class="n">login</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">user</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">HttpResponseRedirect</span><span class="p">(</span><span class="n">reverse</span><span class="p">(</span><span class="s">"index"</span><span class="p">))</span>
        <span class="c1"># Otherwise, return login page again with new context
</span>        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">render</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="s">"users/login.html"</span><span class="p">,</span> <span class="p">{</span>
                <span class="s">"message"</span><span class="p">:</span> <span class="s">"Invalid Credentials"</span>
            <span class="p">})</span>
    <span class="k">return</span> <span class="n">render</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="s">"users/login.html"</span><span class="p">)</span>
</code></pre></div></div>

<p>Now, we’ll create the <code class="language-plaintext highlighter-rouge">user.html</code> file that the <code class="language-plaintext highlighter-rouge">index</code> function renders when a user is authenticated:</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
{% extends "users/layout.html" %}

{% block body %}
    <span class="nt">&lt;h1&gt;</span>Welcome, {{ request.user.first_name }}<span class="nt">&lt;/h1&gt;</span>
    <span class="nt">&lt;ul&gt;</span>
        <span class="nt">&lt;li&gt;</span>Username: {{ request.user.username }}<span class="nt">&lt;/li&gt;</span>
        <span class="nt">&lt;li&gt;</span>Email: {{ request.user.email }}<span class="nt">&lt;/li&gt;</span>
    <span class="nt">&lt;/ul&gt;</span>

    <span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">"{% url 'logout' %}"</span><span class="nt">&gt;</span>Log Out<span class="nt">&lt;/a&gt;</span>
{% endblock %}

</code></pre></div></div>

<p>Finally, to allow the user to log out, we’ll update the <code class="language-plaintext highlighter-rouge">logout_view</code> function so that it uses Django’s built-in <code class="language-plaintext highlighter-rouge">logout</code> function:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">logout_view</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
    <span class="n">logout</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">render</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="s">"users/login.html"</span><span class="p">,</span> <span class="p">{</span>
                <span class="s">"message"</span><span class="p">:</span> <span class="s">"Logged Out"</span>
            <span class="p">})</span>
</code></pre></div></div>

<p>Now that we’re finished, here’s a demonstration of the site</p>

<p><img src="Lecture%204%20-%20CS50's%20Web%20Programming%20with%20Python%20and%20JavaScript_files/demo.gif" alt="Demo"></p>

<p>That’s all for this lecture! Next time, we’ll learn our second programming language of the course: JavaScript.</p>


                </main>

            </div>

        </div>

        
 
        <script src="Lecture%204%20-%20CS50's%20Web%20Programming%20with%20Python%20and%20JavaScript_files/page.js"></script>

    


</body></html>